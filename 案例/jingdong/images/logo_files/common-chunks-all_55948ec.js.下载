define("disk-share:widget/system/util/apis.js",function(n,e,i){function o(n){return new Promise(function(e,i){$.getJSON("/pcloud/user/getinfo",{query_uk:n,third:0},function(n){0===n.errno&&n.user_info?e(n.user_info):i(n.show_msg)}).fail(function(){i("fail")})})}function t(n){var e=window.locals.get("__elink_op_user_info");return e?e:o(n).then(function(n){return window.locals.set("__elink_op_user_info",n),n})}i.exports={getUserInfo:o,getUserInfoCache:t}});
;define("disk-share:widget/system/util/elinkThemeRender.js",function(e,t,n){function o(e,t){if(e){var n=$(".module-share-top-bar .g-button[title=保存到网盘]"),o=$("#shareqr .g-button[title=保存到我的百度网盘]");n.remove(),o.remove()}if(t){var r=$(".module-share-top-bar .g-button[title^=下载]"),i=$("#shareqr .g-button[title^=下载]");r.remove(),i.remove()}}n.exports.getTransferAndDownloadStatus=function(e){window.locals.get("Elink_info","Espace_info",function(t,n){function r(e){return t.forbidlist&&-1!==t.forbidlist.indexOf(e)}if(t&&n&&1===t.isElink){var i=r("transfer"),a=r("download");o(i,a),e&&e({cantTransfer:i,cantDownload:a})}else e&&e({cantTransfer:!1,cantDownload:!1})})}});
;define("disk-share:widget/system/util/eFollow.js",function(o,e,n){function t(){function o(){var o=window.locals.get("share_uk"),n=window.locals.get("uk"),t="https://"+u+"/disk/main#/im/session";e.goIMLink.attr("href",t+"?fromId="+n+"&toId="+o+"&covType=companyCov&from=e-web-share")}var e={followWrap:$(".enterprise-follow"),followBtn:$(".enterprise-follow .follow"),goIMBtn:$(".enterprise-follow .go-im"),goIMLink:$(".enterprise-follow .go-im a"),notOpenIM:$(".enterprise-follow .not-open-im")};e.followWrap.show(),s().then(function(n){return 1!==n.im_open?void e.notOpenIM.show():void(1===n.is_follow?(e.goIMLink.attr("href",""),e.goIMBtn.show(),o()):(e.followBtn.show(),r.log.send({type:"e_fol_link_show",value:"带有关注按钮的外链页展现"})))},function(o){r.log.send({type:"e_fol_request_error",value:o})}),e.followBtn.on("click",c.debounce(function(){r.log.send({type:"e_clk_fol",value:"用户在企业外链页点击关注"}),l(!0).then(function(){e.followBtn.hide(),e.goIMBtn.show(),r.ui.tip({mode:"success",msg:"关注成功",autoClose:!0,className:"enterprise-module-yun-tip"}),o(),r.log.send({type:"e_clk_fol_succ",value:"用户在企业外链页关注成功"})},function(){r.ui.tip({mode:"failure",msg:"关注失败，请稍后再试",autoClose:!0})})},500)),e.goIMBtn.on("click",function(){r.log.send({type:"e_clk_send_msg",value:"企业外链点击发消息"})})}function s(){return new Promise(function(o,e){var n=window.locals.get("share_uk"),t={ciduk:n};$.get("/basembox/follow/getinfo",t,function(n){n&&0===n.errno?o(n):e(n.show_msg)}).fail(function(o){e(o.statusText)})})}function l(o){return new Promise(function(e,n){var t=window.locals.get("share_uk"),s={ciduk:t,method:o?"follow":"unfollow",source:"101"};$.post("/basembox/follow/set",s,function(o){o&&0===o.errno?e(o):n(o.show_msg)}).fail(function(o){n(o.statusText)})})}function i(){var o="/act/api/conf?conf_key=enterprise_im_point";$.ajax({url:o,type:"get",dataType:"json",success:function(o){try{var e=o.data[0].conf_value.conf||{},n=JSON.parse(e),s="1"===n.open;s&&t()}catch(l){console.log(l)}},error:function(){}})}var r=o("system-core:context/context.js").instanceForSystem,c=o("base:widget/libs/underscore.js"),u=window.host&&window.host.HOST_PAN||"pan.baidu.com";n.exports=i});
;define("disk-share:widget/system/util/eCard.js",function(e,t,i){function r(e){for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i="",r=e;r>0;--r)i+=t[Math.floor(Math.random()*t.length)];return i}function a(e){for(var t=0,i=0;i<e.length;i++){var r=e.charAt(i);t+="@"===r||/[a-zA-Z]/.test(r)&&r===r.toUpperCase()||null!=r.match(/[^\x00-\xff]/gi)?2:1}return t}function n(e,t,i,r){var a=l(t),n=l(e);if(!a||!n)return void console.log("不存在",a,"或",n);var s=new f(e),o=a.val();s.setText(o),s.on("success",function(){p.ui.tip({mode:"success",msg:"复制成功！"}),p.log.send({type:"enterprise_disk_business_card_item_click",fromPage:r,cardType:i.card_type===h.enterprise?"enterprise":"staff"})}),s.on("error",function(){p.ui.tip({mode:"caution",msg:"复制失败！",hasClose:!0,autoClose:!1})})}function s(e,t,i,s){this.trigger=l(e)[0];var o=document.createElement("div");o.setAttribute("style","position: absolute; top: 0px; left: 0px; width: 100%;");var c=document.createElement("div"),d="tooltip-"+r(6),f=this;c.className="e-tooltip-wrap "+d,c.innerHTML='        <div class="e-tooltip">			  <input class="value" disabled />			  <div class="btn" role="button" id="e-phone-copy">复制</div>            <div class="e-triangle"></div>        </div>',o.appendChild(c),document.body.appendChild(o),this.el=c,l("."+d+" .value").val(t).attr("size",a(t||5)+1),n("."+d,"."+d+" .value",i,s),this.cancelOpt=!1,this.show=function(e){this.el.style.display="block";var t=e.pageX-e.offsetX+e.target.offsetWidth/2-this.el.offsetWidth/2,i=e.pageY-e.offsetY-this.el.offsetHeight;this.el.style.left=t+"px",this.el.style.top=i+"px"},this.hide=function(){setTimeout(function(){return f.cancelOpt?void(f.cancelOpt=!1):void(f.el.style.display="none")},50)},this.trigger.addEventListener("mouseenter",function(e){f.show(e)}),this.trigger.addEventListener("mouseleave",function(e){f.hide(e)}),this.el.addEventListener("mouseenter",function(){f.cancelOpt=!0}),this.el.addEventListener("mouseleave",function(e){f.hide(e)})}function o(e,t,i,r){e.infos.forEach(function(a){e[a]&&(l(".enterprise-card-mini "+t+"-card ."+a).css("display","inline-block"),new s(".enterprise-card-mini "+t+"-card ."+a,e[a],i,r))}),e.avatar&&l(".avatar .photo-frame img").css({"object-fit":"cover",width:"44px",height:"44px"}).attr("src",e.avatar),e.name&&l(".username").text(e.name),e.intro&&l(".author-desc").text(e.intro),l(".enterprise-card-mini").show()}function c(e,t,i,r){e.infos.forEach(function(s){var o=e[s];o&&(l(".enterprise-card "+t+"-card-detail .e-row."+s).show(),itemPrefix=t+"-"+s,l(itemPrefix+"-value").val(o).attr("size",a(o||5)+1),n(itemPrefix+"-copy",itemPrefix+"-value",i,r))}),e.avatar&&l(".share-person-avatar img").css({"object-fit":"cover"}).attr("src",e.avatar),e.name&&l(".share-person-username").text(e.name),e.intro&&l(".author-intro").text(e.intro)}function d(e,t){var i={},r="",a=e.card_type===h.enterprise?"enriskinfo":"riskinfo",n=e[a];if(n){var s=n.split(";");s.forEach(function(t){e[t]=""})}if(e.card_type===h.enterprise)i={phone:e.enphone,email:e.enemail,address:e.enaddress,avatar:e.logo,name:e.enname},i.infos=["phone","email","address"],r=".ent";else{if(e.card_type!==h.staff)return;i={phone:e.phone,wechat:e.vxnum,email:e.email,avatar:e.avatar,name:e.uname,intro:e.title},i.infos=["phone","wechat","email"],r=".staff"}"sharecode"===t?o(i,r,e,t):(c(i,r,e,t),e.card_type===h.enterprise&&l(".enterprise-info .from-info").hide()),p.log.send({type:"enterprise_disk_business_card_show",fromPage:t,cardType:e.card_type===h.enterprise?"enterprise":"staff"})}var l=e("base:widget/libs/jquerypacket.js"),f=e("base:widget/clipboard/myClipboard.js"),p=e("system-core:context/context.js").instanceForSystem,h={enterprise:2,staff:1};i.exports=d});
;define("disk-share:widget/system/util/ticketBind.js",function(i,n,e){var t=function(){var i=window.locals.get("share_uk"),n=window.locals.get("shareid"),e=window.location.pathname.split("/s/")[1];return e?new Promise(function(t,o){$.get("/api/shorturlinfo",{root:1,uk:i,shareid:n,shorturl:e},function(i){i&&0===i.errno?t(1===i.privilege_type?!0:!1):o(i.show_msg)}).fail(function(){o("fail")})}):Promise.resolve(!1)},o=function(){var i=window.locals.get("share_uk"),n=window.locals.get("shareid");return new Promise(function(e,t){var o={tkappid:1e4,activity_uk:i,activity_id:n};$.post("/ticket/api/getbindinfo",o,function(i){if(i&&0===i.errno){var n=i.data,o=1e3*n.activity_expired<=+new Date;n._isValid=n.remain_count>0&&!o,window.locals.set("bind_info",n),e(n)}else t(i.show_msg)}).fail(function(){t("fail")})})},r=function(){var i=window.locals.get("bind_info");return i?Promise.resolve(i):t().then(function(i){return i?o():null},function(i){return console.error(i),null})};e.exports=r});
;define("disk-share:widget/system/util/certFollow.js",function(o,e,n){function t(){function o(){var o=r,n=window.locals.get("uk"),t="https://"+u+"/disk/main#/im/session";e.goIMLink.attr("href",t+"?fromId="+n+"&toId="+o+"&covType=companyCov&from=e-web-share")}var e={followWrap:$(".enterprise-follow"),followBtn:$(".enterprise-follow .follow"),goIMBtn:$(".enterprise-follow .go-im"),goIMLink:$(".enterprise-follow .go-im a"),notOpenIM:$(".enterprise-follow .not-open-im")};e.followWrap.show(),s().then(function(n){return 1!==n.im_open?void e.notOpenIM.show():(r=n.ciduk,void(1===n.is_follow?(e.goIMLink.attr("href",""),e.goIMBtn.show(),o()):(e.followBtn.show(),c.log.send({type:"e_fol_link_show",value:"带有关注按钮的外链页展现"}))))},function(o){c.log.send({type:"e_fol_request_error",value:o})}),e.followBtn.on("click",f.debounce(function(){c.log.send({type:"e_clk_fol",value:"用户在企业外链页点击关注"}),i(!0).then(function(){e.followBtn.hide(),e.goIMBtn.show(),c.ui.tip({mode:"success",msg:"关注成功",autoClose:!0,className:"enterprise-module-yun-tip"}),o(),c.log.send({type:"e_clk_fol_succ",value:"用户在企业外链页关注成功"})},function(){c.ui.tip({mode:"failure",msg:"关注失败，请稍后再试",autoClose:!0})})},500)),e.goIMBtn.on("click",function(){c.log.send({type:"e_clk_send_msg",value:"企业外链点击发消息"})})}function s(){return new Promise(function(o,e){var n=window.locals.get("share_uk"),t={uk:n};$.get("/basembox/follow/getinfo",t,function(n){n&&0===n.errno?o(n):e(n.show_msg)}).fail(function(o){e(o.statusText)})})}function i(o){return new Promise(function(e,n){var t={ciduk:r,method:o?"follow":"unfollow",source:"101"};$.post("/basembox/follow/set",t,function(o){o&&0===o.errno?e(o):n(o.show_msg)}).fail(function(o){n(o.statusText)})})}function l(){var o="/act/api/conf?conf_key=enterprise_im_point";$.ajax({url:o,type:"get",dataType:"json",success:function(o){try{var e=o.data[0].conf_value.conf||{},n=JSON.parse(e),s="1"===n.open;s&&t()}catch(i){console.log(i)}},error:function(){}})}var r,c=o("system-core:context/context.js").instanceForSystem,f=o("base:widget/libs/underscore.js"),u=window.host&&window.host.HOST_PAN||"pan.baidu.com";n.exports=l});
;define("disk-share:widget/system/util/makeup.js",function(e,a,s){var t=e("base:widget/libs/jquerypacket.js"),h={share_back:"https://staticsns.cdn.bcebos.com/amis/2022-10/1667033900398/web_svip_share_code.png",share_head:"#E9C87A",share_hover:"#FDF2E0",share_name:"#64360D",share_text:"#64360D",share_send_button:"#FFFFFF",share_send_text:"#402200",share_page_back:"https://staticsns.cdn.bcebos.com/amis/2022-10/1667033901035/web_svip_share_list.png",share_page_head:"#F8E0B5",share_page_hover:"#F1C77C",share_page_name:"#402200",share_page_send_button:"#FFD58C",share_page_send_text:"#402200",share_page_text:"#8C7861"},r={themeBack:t(".acss-header .theme-share-back"),themeHead:t(".theme-share-head"),themeName:t(".theme-share-name"),themeText:t(".theme-share-text"),themeNameHover:t(".theme-share-name-hover"),themePageBack:t(".theme-share-page-back"),themePageHead:t(".theme-share-page-head"),themePageName:t(".theme-share-page-name"),themePageHover:t(".theme-share-page-name-hover"),shareLimit:t(".limit-share-lock-icon")},n=function(e){r.themeBack.css({background:"url("+e.share_back+") no-repeat"}),r.themeHead.css({background:e.share_head}),r.themeName.css({color:e.share_name}),r.themeText.css({color:e.share_text}),r.themeNameHover.css({background:e.share_send_button,color:e.share_send_text}),r.themeNameHover.hover(function(){t(this).css({background:e.share_hover})},function(){t(this).css({background:e.share_send_button})}),window.locals.get("sharetype",function(a){a+""=="4"&&r.shareLimit.css({background:e.share_send_button,color:e.share_send_text})})},o=function(e){r.themePageBack.css({background:"url("+e.share_page_back+") center/cover no-repeat #fff"}),r.themePageHead.css({borderColor:e.share_page_head}),r.themePageName.css({color:e.share_page_name}),r.themePageHover.css({background:e.share_page_send_button,color:e.share_page_send_text}),r.themePageHover.hover(function(){t(this).css({background:e.share_page_hover})},function(){t(this).css({background:e.share_page_send_button})})};s.exports=function(e,a){var s=1;window.locals.get("share_uk",function(r){t.getJSON("/act/v2/skin/inuse",{uk:r,stype:1001,share_page:s},function(s){var r=h;0===s.errno?(r=t.extend({},h,s.data.web_sharelink||{}),a.log.send({type:"theme-success",value:"加载配置成功",from:s.data.id})):a.log.send({type:"theme-fail-default",value:"加载配置失败显示默认配置"}),"sharecode"===e?n(r):o(r)})})}});
;define("disk-share:widget/system/verifyCodeDialog/newVerify.js",function(e,i,t){var o,n=e("base:widget/libs/jquerypacket.js"),d=e("system-core:context/context.js").instanceForSystem,s=function(){this.token=void 0,this.type=void 0};s.prototype.build=function(){var e=['<div class="download-verify" style="margin-top: 20px;margin-bottom: 20px;padding: 0 28px;text-align: left;font-size: 12px;" id="downloadVerify">',"</div>"],i={title:"添加好友",className:"add-friend",body:e.join(""),draggable:!1,width:"480px",position:{xy:"center"}};"undefined"==typeof o&&(o=d.ui.window(i)),n("#downloadVerify").parents(".dialog").css("width","376px"),o.show()},s.prototype.show=function(i){this.build(),e.async("disk-share:widget/system/verifyCodeDialog/verifyUser.min.js",function(e){new e.VcodeForPC({container:document.getElementById("downloadVerify"),ak:8241,cb:function(e,t){i.onSubmitFunc&&i.onSubmitFunc(e,t),o.hide()}})})},t.exports=new s});
;define("disk-share:widget/system/util/monitor/monitor.js",function(e,r,s){var t=e("system-core:context/context.js").instanceForSystem;s.exports=function(e){e=e||{};var r=e.scene,s=e.status,o=e.errno,n=e.from||"",a=e.source||"";if(r||s){var c={shareFile:"web_create_share",extract:"web_sharelink_extract",transfer:"web_sharelink_transfer",download:"web_sharelink_download"},i={success:"_success",fail:"_fail",error:"_error"};c[r]&&i[s]&&t.log.send({type:c[r]+i[s],errno:o,from:n,source:a})}}});
;define("disk-share:widget/system/util/enterpriseThemeRender.js",function(e,r,t){function s(e,r){var t={enterprise:2,staff:1};return e?e.card_type===t.enterprise?"来自企业的分享":"来自企业员工的分享":r?"来自企业的分享":"来自企业员工的分享"}var i=e("base:widget/libs/jquerypacket.js"),a=e("system-core:context/context.js").instanceForSystem,n=e("disk-share:widget/system/util/ticketBind.js"),o=e("disk-share:widget/system/util/eCard.js"),m=e("disk-share:widget/system/util/eFollow.js"),d=e("disk-share:widget/system/util/elinkThemeRender.js"),h=e("disk-share:widget/system/util/apis.js"),c={shareCodeConfig:{fromCertShareText:"来自企业的分享",avatarBg:"#ffffff",themeName:"#ffffff",themeText:"#ffffff",themeDesc:"#ffffff",themeFromCertShare:"10px",themeBtn:{bg:"#0065dd",color:"#ffffff",border:"1px solid #ffffff"},shareCodeBgImg:{img:"https://staticwx.cdn.bcebos.com/mini-program%2Fimages%2Fcertification-user-bg-web.png",normalImg:"https://staticwx.cdn.bcebos.com/mini-program/images/enterprise/web%E5%A4%96%E9%93%BE%E9%A1%B5%E8%83%8C%E6%99%AF.png",size:"100% 100%"},submitBtn:{bg:"#0065dd",color:"#ffffff"},certTip:{top:"225px"},limit:{limitNum:"150px"},tip:{top:"225px"}}},p=function(e,r){var t={tip:i(".tip"),abbrName:i(".verify-user .username"),enterprise:i(".verify-user .enterprise"),vipIcon:i(".verify-user-avatar"),avatarIcon:i(".photo-frame .cert-info"),themeAvatar:i(".theme-share-head"),themeName:i(".theme-share-name"),enterpriseThemeName:i(".enterprise.theme-share-name"),themeFromCertShare:i(".from-cert-share"),themeText:i(".theme-share-text"),themeDesc:i(".author-desc"),themeFriendBtn:i(".verify-btn .verify-friend"),themeSendBtn:i(".verify-btn .verify-send"),avatar:i(".avatar"),submitBtn:i(".submit-a"),certTip:i(".cert-tip"),memo:i(".verify-memo"),memoText:i(".verify-memo-text"),limitShareNum:i(".limit-share-limit-num"),enterpriseRight:i(".enterprise-right"),enterpriseRightIcon:i(".enterprise-right .right-icon"),limitShareLockIcon:i(".limit-share-lock-icon"),verifyBtn:i(".verify-btn")},s=c.shareCodeConfig;t.abbrName.text(e.name),t.themeDesc.text(e.brief),0===e.certStatus&&t.avatarIcon.addClass("cert-icon"),e.isEnterpriseOwner!==!0&&(t.enterprise.text("-"+e.space_name),t.enterprise.css({display:"inline-block",_display:"inline"})),4!==+r&&t.themeFromCertShare.text(s.fromCertShareText),e.memo&&(t.memoText.text("链接备注："+e.memo),t.memo.show(),t.certTip.css({top:s.certTip.top}),t.tip.css({top:s.tip.top}),t.limitShareNum.css({top:s.limit.limitNum})),t.certTip.show(),t.themeAvatar.css({background:s.avatarBg}),t.themeName.css({color:s.themeName}),t.themeText.css({color:s.themeText}),t.themeDesc.css({color:s.themeDesc}),t.themeFromCertShare.css({"font-size":s.themeFromCertShare}),t.themeFriendBtn.css({background:s.themeBtn.bg,color:s.themeBtn.color,border:s.themeBtn.border}),t.themeSendBtn.css({background:s.themeBtn.bg,color:s.themeBtn.color,border:s.themeBtn.border});var a=e.isCertValid?s.shareCodeBgImg.img:s.shareCodeBgImg.normalImg;t.avatar.parent().css({"background-image":"url("+a+")","background-size":s.shareCodeBgImg.size}),t.submitBtn.css({background:s.submitBtn.bg,border:"1px solid "+s.submitBtn.bg}),t.vipIcon.hide(),t.limitShareLockIcon.hide(),t.verifyBtn.hide(),e.isCertValid||t.enterpriseThemeName.hide()},f=function(e){var r={shareContent:i("#bd-main"),shareList:i("#bd-main .bd-left"),sideContent:i(".bd-aside"),sideTopBg:i(".cert-top-banner"),sideBack:i(".theme-share-page-back"),sidePersonInfo:i(".module-share-person-info"),certIcon:i(".share-person-avatar .cert-info"),sharePersonInfoName:i(".share-person-data .share-person-username"),sharePersonInfoIntro:i(".author-desc .author-intro"),sharePersonCertinfo:i(".share-person-certinfo"),themeInfoContnet:i(".module-share-person-info .share-person-inner"),themeAvatar:i(".theme-share-page-head"),themeName:i(".theme-share-page-name"),themeIntro:i(".author-intro"),themePageHover:i(".theme-share-page-name-hover"),themeSubscribe:i(".verb-button"),frameContent:i(".frame-content"),frameMain:i(".frame-main"),certUserShareList:i(".cert-user-share-list"),enterpriseInfo:i(".enterprise-info"),enterpriseInfoFrom:i(".enterprise-info .from-info"),enterprisememo:i(".enterprise-memo"),enterprisememoInfo:i(".enterprise-memo .memo-info"),shareLimit:i(".icon-share-lock"),vipIcon:i(".share-person-data-top .sicon"),lhbButton:i(".btn-img-tips"),verifyFriend:i(".verify-friend"),verifySend:i(".verify-send")};r.frameContent.css({"margin-right":"244px"}),r.frameMain.css({border:"none"}),r.shareContent.css({border:"none"}),r.shareList.css({margin:"0px 250px 0 0",border:"1px solid #e2e2e2"}),r.sideContent.css({width:"230px"}),r.sideTopBg.css({height:"24px",position:"absolute",top:"0px",width:"100%"}),r.sideTopBg.addClass("person-info-top-bg"),r.sideBack.css({background:"#f7f7f7",top:"0px",width:"230px"}),r.sidePersonInfo.css({background:"#fff",height:"100%","box-sizing":"border-box",padding:"10px 16px"}),e.isCertValid&&r.certIcon.addClass("cert-icon"),r.sharePersonInfoName.text(e.name),r.sharePersonInfoIntro.text(e.brief),r.sharePersonCertinfo.show(),r.themeInfoContnet.css({padding:"38px 0 10px 0"}),r.themeAvatar.css({"border-color":"#0065dd"}),r.themeName.css({color:"#333333","font-weight":"bold","max-width":"149px"}),r.themeIntro.css({color:"#666666"}),r.themePageHover.css({background:"#0065dd",color:"#fff"}),r.sidePersonInfo.addClass("is-cert"),e.isCertValid&&r.enterpriseInfoFrom.text("来自："+e.space_name),r.enterpriseInfo.show(),r.shareLimit.hide(),r.lhbButton.hide(),r.verifyFriend.hide(),r.verifySend.hide(),r.vipIcon.hide()},l={1:{name:"基础券",saveNum:"3000"},2:{name:"豪华券",saveNum:"5万"}},u=function(e){i(".cert-user-share-list").text(e).show()},g=function(e){return 1!==window.locals.get("loginstate")&&e.isCertValid?void u(e.shareListBrand):void n().then(function(r){if(r){var t="分享者为您提供了极速下载 单次保存"+l[r.package_type].saveNum+"个文件";i(".cert-user-share-bind-info-head").text(t),i(".cert-user-share-bind-info").addClass(r._isValid?"":"is-disabled").show(),a.log.send(r._isValid?{type:"web_share_list_page_speed_coupon_display",value:"外链页展示绑定企业券权益"}:{type:"web_share_list_page_speed_coupon_not_valid_display",value:"外链页展示绑定企业券权益，已失效"})}else e.isCertValid&&u(e.shareListBrand)},function(e){console.error(e)})};t.exports=function(e,r,t){window.locals.get("Elink_info","Espace_info","card_info",function(a,n,c){if(a&&n){var l={};l.isEnterpriseLink=1===a.isElink,l.memo=a.Elink_memo,l.isEnterpriseOwner=1===n.Espace_op_role,l.certStatus=n.Espace_cert_status||0,l.isCertValid=0===n.Espace_cert_status,l.name=l.isEnterpriseOwner?n.Espace_name:n.Espace_op_name,l.brief=l.isCertValid?n.Espace_brief:"",l.space_name=n.Espace_name,l.opStatus=n.Espace_op_status||0,l.productType=n.Espace_product_type,l.productStatus=n.Espace_product_status,l.shareListBrand=s(c,l.isEnterpriseOwner),i("#bd").addClass("is-enterprise"),l.isCertValid&&i("#bd").addClass("is-cert-valid");var u=a.forbidlist&&-1!==a.forbidlist.indexOf("transfer"),b=a.forbidlist&&-1!==a.forbidlist.indexOf("download");l.isEnterpriseLink&&"sharelist"===e&&(u||b)&&(l.shareListBrand+="（文件仅支持查看）"),l.isEnterpriseLink&&("sharecode"===e?window.locals.get("sharetype",function(e){p(l,e)}):"sharelist"===e&&(g(l),f(l)),l.isCertValid||h.getUserInfoCache(a.Elink_opuk).then(function(r){var t=i("sharecode"===e?".username":".share-person-username"),s=i("sharecode"===e?".avatar .photo-frame img":".share-person-avatar img");t.text(r.uname),s.attr("src",r.avatar_url)})),"sharelist"===e&&d.getTransferAndDownloadStatus(),l.isCertValid&&c&&o(c,e),m(),r(l)}else t()})}});
;define("disk-share:widget/system/util/certThemeRender.js",function(e,t,r){var s=e("base:widget/libs/jquerypacket.js"),o=e("system-core:context/context.js").instanceForSystem,a=e("disk-share:widget/system/util/ticketBind.js"),n=(window.yunData,e("disk-share:widget/system/util/certFollow.js")),i={shareCodeConfig:{fromCertShareText:"来自企业的分享",avatarBorder:"#C3E9FE",themeName:"#ffffff",themeText:"#ffffff",themeDesc:"#ffffff85",themeFromCertShare:"10px",themeBtn:{bg:"#0065dd",color:"#ffffff",border:"1px solid #ffffff"},shareCodeBgImg:{img:"https://staticwx.cdn.bcebos.com/mini-program%2Fimages%2Fcertification-user-bg-web.png",size:"100% 100%"},submitBtn:{bg:"#0065dd",color:"#ffffff"}}},h=function(e,t){var r={abbrName:s(".verify-user .username"),avatarIcon:s(".photo-frame .cert-info"),vipIcon:s(".verify-user-avatar"),themeAvatarBorder:s(".theme-share-head"),themeName:s(".theme-share-name"),themeFromCertShare:s(".from-cert-share"),themeText:s(".theme-share-text"),themeDesc:s(".author-desc"),themeFriendBtn:s(".verify-btn .verify-friend"),themeSendBtn:s(".verify-btn .verify-send"),avatar:s(".avatar"),submitBtn:s(".submit-a"),certTip:s(".cert-tip")},o=i.shareCodeConfig;r.abbrName.text(e.abbr_name),r.themeDesc.text(e.cert_info),r.avatarIcon.addClass("cert-icon"),4!==+t&&r.themeFromCertShare.text(o.fromCertShareText),r.themeAvatarBorder.css({background:o.avatarBorder}),r.themeName.css({color:o.themeName}),r.themeText.css({color:o.themeText}),r.themeDesc.css({color:o.themeDesc}),r.themeFromCertShare.css({"font-size":o.themeFromCertShare}),r.themeFriendBtn.css({background:o.themeBtn.bg,color:o.themeBtn.color,border:o.themeBtn.border}),r.themeSendBtn.css({background:o.themeBtn.bg,color:o.themeBtn.color,border:o.themeBtn.border}),r.avatar.parent().css({"background-image":"url("+o.shareCodeBgImg.img+")","background-size":o.shareCodeBgImg.size}),r.submitBtn.css({background:o.submitBtn.bg,border:"1px solid "+o.submitBtn.bg}),r.certTip.show(),r.vipIcon.hide()},c=function(e){var t={shareContent:s("#bd-main"),shareList:s("#bd-main .bd-left"),sideContent:s(".bd-aside"),sideTopBg:s(".cert-top-banner"),sideBack:s(".theme-share-page-back"),sidePersonInfo:s(".module-share-person-info"),certIcon:s(".share-person-avatar .cert-info"),sharePersonInfoName:s(".share-person-data .share-person-username"),sharePersonInfoIntro:s(".author-desc .author-intro"),sharePersonCerinfo:s(".share-person-certinfo"),themeInfoContnet:s(".module-share-person-info .share-person-inner"),themeAvatar:s(".theme-share-page-head"),themeName:s(".theme-share-page-name"),themeIntro:s(".author-intro"),themePageHover:s(".theme-share-page-name-hover"),themeSubscribe:s(".verb-button"),frameContent:s(".frame-content"),frameMain:s(".frame-main"),vipIcon:s(".share-person-data-top .sicon"),certUserShareList:s(".cert-user-share-list")};t.frameContent.css({"margin-right":"244px"}),t.frameMain.css({border:"none"}),t.shareContent.css({border:"none"}),t.shareList.css({margin:"0px 250px 0 0",border:"1px solid #e2e2e2"}),t.sideContent.css({width:"230px"}),t.sideTopBg.css({height:"24px",position:"absolute",top:"0px",width:"100%"}),t.sideTopBg.addClass("person-info-top-bg"),t.sideBack.css({background:"#f7f7f7",top:"0px",width:"230px"}),t.sidePersonInfo.css({background:"#fff",height:"100%","box-sizing":"border-box"}),t.certIcon.addClass("cert-icon"),t.sharePersonInfoName.text(e.abbr_name),t.sharePersonInfoIntro.text(e.cert_info),e.isOwner===!1&&t.sharePersonCerinfo.show(),t.themeInfoContnet.css({padding:"38px 0 10px 0"}),t.themeAvatar.css({"border-color":"#0065dd"}),t.themeName.css({color:"#333333","font-weight":"bold"}),t.themeIntro.css({color:"#666666"}),t.themePageHover.css({background:"#0065dd",color:"#fff"}),t.sidePersonInfo.addClass("is-cert"),t.vipIcon.hide()},d={1:{name:"基础券",saveNum:"3000"},2:{name:"豪华券",saveNum:"5万"}},m=function(){var e=i.shareCodeConfig.fromCertShareText;s(".cert-user-share-list").text(e).show()},f=function(){return 1!==window.locals.get("loginstate")?void m():void a().then(function(e){if(e){var t="分享者为您提供了极速下载 单次保存"+d[e.package_type].saveNum+"个文件";s(".cert-user-share-bind-info-head").text(t),s(".cert-user-share-bind-info").addClass(e._isValid?"":"is-disabled").show(),o.log.send(e._isValid?{type:"web_share_show_coup_bind",value:"外链页展示绑定企业券权益"}:{type:"web_share_show_coup_bind_not_valid",value:"外链页展示绑定企业券权益，已失效"})}else m()},function(e){console.error(e)})};r.exports=function(e,t,r){var o="/api/certuser/get?msg_flag=1&by_op=0&uk="+window.locals.get("share_uk");s.get(o,function(r){var s=r.data||{},o=2===s.cert_status&&0===s.cancel_status,a=2===s.cert_try_status;s.isCertUser=o||a,s.isOwner=!!window.locals.get("self"),s.useCertTheme=!1,window.locals.get("Elink_info",function(t){t&&(0===t.isElink&&t.eflag_disable===!1&&(s.useCertTheme=!0),s.isCertUser&&s.useCertTheme&&("sharecode"===e?window.locals.get("sharetype",function(e){h(s,e)}):"sharelist"===e&&(f(),c(s),n())))}),t(s)},"json").fail(r)}});
;define("disk-share:widget/system/util/getAdList/MD5.js",function(n,r,t){function e(n,r){n[r>>5]|=128<<r%32,n[(r+64>>>9<<4)+14]=r;for(var t=1732584193,e=-271733879,u=-1732584194,h=271733878,s=0;s<n.length;s+=16){var A=t,d=e,g=u,v=h;t=f(t,e,u,h,n[s+0],7,-680876936),h=f(h,t,e,u,n[s+1],12,-389564586),u=f(u,h,t,e,n[s+2],17,606105819),e=f(e,u,h,t,n[s+3],22,-1044525330),t=f(t,e,u,h,n[s+4],7,-176418897),h=f(h,t,e,u,n[s+5],12,1200080426),u=f(u,h,t,e,n[s+6],17,-1473231341),e=f(e,u,h,t,n[s+7],22,-45705983),t=f(t,e,u,h,n[s+8],7,1770035416),h=f(h,t,e,u,n[s+9],12,-1958414417),u=f(u,h,t,e,n[s+10],17,-42063),e=f(e,u,h,t,n[s+11],22,-1990404162),t=f(t,e,u,h,n[s+12],7,1804603682),h=f(h,t,e,u,n[s+13],12,-40341101),u=f(u,h,t,e,n[s+14],17,-1502002290),e=f(e,u,h,t,n[s+15],22,1236535329),t=i(t,e,u,h,n[s+1],5,-165796510),h=i(h,t,e,u,n[s+6],9,-1069501632),u=i(u,h,t,e,n[s+11],14,643717713),e=i(e,u,h,t,n[s+0],20,-373897302),t=i(t,e,u,h,n[s+5],5,-701558691),h=i(h,t,e,u,n[s+10],9,38016083),u=i(u,h,t,e,n[s+15],14,-660478335),e=i(e,u,h,t,n[s+4],20,-405537848),t=i(t,e,u,h,n[s+9],5,568446438),h=i(h,t,e,u,n[s+14],9,-1019803690),u=i(u,h,t,e,n[s+3],14,-187363961),e=i(e,u,h,t,n[s+8],20,1163531501),t=i(t,e,u,h,n[s+13],5,-1444681467),h=i(h,t,e,u,n[s+2],9,-51403784),u=i(u,h,t,e,n[s+7],14,1735328473),e=i(e,u,h,t,n[s+12],20,-1926607734),t=o(t,e,u,h,n[s+5],4,-378558),h=o(h,t,e,u,n[s+8],11,-2022574463),u=o(u,h,t,e,n[s+11],16,1839030562),e=o(e,u,h,t,n[s+14],23,-35309556),t=o(t,e,u,h,n[s+1],4,-1530992060),h=o(h,t,e,u,n[s+4],11,1272893353),u=o(u,h,t,e,n[s+7],16,-155497632),e=o(e,u,h,t,n[s+10],23,-1094730640),t=o(t,e,u,h,n[s+13],4,681279174),h=o(h,t,e,u,n[s+0],11,-358537222),u=o(u,h,t,e,n[s+3],16,-722521979),e=o(e,u,h,t,n[s+6],23,76029189),t=o(t,e,u,h,n[s+9],4,-640364487),h=o(h,t,e,u,n[s+12],11,-421815835),u=o(u,h,t,e,n[s+15],16,530742520),e=o(e,u,h,t,n[s+2],23,-995338651),t=c(t,e,u,h,n[s+0],6,-198630844),h=c(h,t,e,u,n[s+7],10,1126891415),u=c(u,h,t,e,n[s+14],15,-1416354905),e=c(e,u,h,t,n[s+5],21,-57434055),t=c(t,e,u,h,n[s+12],6,1700485571),h=c(h,t,e,u,n[s+3],10,-1894986606),u=c(u,h,t,e,n[s+10],15,-1051523),e=c(e,u,h,t,n[s+1],21,-2054922799),t=c(t,e,u,h,n[s+8],6,1873313359),h=c(h,t,e,u,n[s+15],10,-30611744),u=c(u,h,t,e,n[s+6],15,-1560198380),e=c(e,u,h,t,n[s+13],21,1309151649),t=c(t,e,u,h,n[s+4],6,-145523070),h=c(h,t,e,u,n[s+11],10,-1120210379),u=c(u,h,t,e,n[s+2],15,718787259),e=c(e,u,h,t,n[s+9],21,-343485551),t=a(t,A),e=a(e,d),u=a(u,g),h=a(h,v)}return Array(t,e,u,h)}function u(n,r,t,e,u,f){return a(h(a(a(r,n),a(e,f)),u),t)}function f(n,r,t,e,f,i,o){return u(r&t|~r&e,n,r,f,i,o)}function i(n,r,t,e,f,i,o){return u(r&e|t&~e,n,r,f,i,o)}function o(n,r,t,e,f,i,o){return u(r^t^e,n,r,f,i,o)}function c(n,r,t,e,f,i,o){return u(t^(r|~e),n,r,f,i,o)}function a(n,r){var t=(65535&n)+(65535&r),e=(n>>16)+(r>>16)+(t>>16);return e<<16|65535&t}function h(n,r){return n<<r|n>>>32-r}function s(n){for(var r=Array(),t=(1<<g)-1,e=0;e<n.length*g;e+=g)r[e>>5]|=(n.charCodeAt(e/g)&t)<<e%32;return r}function A(n){for(var r=d?"0123456789ABCDEF":"0123456789abcdef",t="",e=0;e<4*n.length;e++)t+=r.charAt(n[e>>2]>>e%4*8+4&15)+r.charAt(n[e>>2]>>e%4*8&15);return t}var d=0,g=8,v=function(n){return A(e(s(n),n.length*g))};t.exports=v});
;define('disk-share:widget/system/util/util.js', function(require, exports, module){ var context = require('system-core:context/context.js').instanceForSystem;

var Grid_Video = /^3gp$|^mpga$|^qt$|^rm$|^wmz$|^wmd$|^wvx$|^wmx$|^wm$|^mpeg$|^swf$|^mpg$|^wmv$|^rmvb$|^mpeg4$|^mp4$|^mpeg2$|^flv$|^avi$|^mkv$|^f4v$|^mov$|^vob$|^m4v$|^dat$|^m3u8$|^m3u$|^asf$|^3g2$|^mj2$|^ts$|^webm$/i;
var Music = /^wma$|^ra$|^ram$|^flac$|^ape$|^aiff$|^mp2$|^ogg$|^dts$|^aif$|^mpega$|^amr$|^mid$|^midi$|^wav$|^mp3$|^aac$|^ac3$|^m4a$/i;
var Grid_Picture = /^jpe$|^cur$|^svg$|^svgz$|^tif$|^tiff$|^ico$|^jpg$|^jpeg$|^gif$|^bmp$|^png$|^webp$|^heic$|^heif$|^avci$|^livp$|^cr2$|^arw$|^dng$|^nef$/i;
var Grid_ZIP = /^zip$|^rar$|^7z$|^cab$|^iso$/i;
var Grid_EXE = /^exe$|^msi$/i;
var Grid_Apple = /^ipa$/i;
var Grid_Android = /^apk$/i;
var Grid_Text = /^rtf$|^txt$/i;
var Grid_Excel = /^xls$|^xlsx$|^xlt$|^xltx$|^csv$/i;
var Grid_Word = /^dot$|^dotx$|^doc$|^docx$/i;
var Grid_PPT = /^pps$|^pot$|^ppsx$|^potx$|^ppt$|^pptx$/i;
var Grid_PDF = /^pdf$/i;
var Grid_Visio = /^vsd$/i;
var Grid_BT = /^torrent$/i;
var Grid_CAD = /^dwt$|^dwg$|^dws$|^dxf$/i;
var Grid_Keynote = /^key^/i;
var Numbers = /^numbers$/i;
var Pages = /^pages$/i;
var PanD = /^PanD$/i;

module.exports = {
    toFriendlyFileSize: function (size, isBit) {
        var B = 1024;
        var K = B * B; // 1024^2
        var M = K * B; // 1024^3
        var G = M * B; // 1024^4;
        var LG = M * 1000; // 1024^3 * 1000
        var BG = M * 10000;
        if (isBit && typeof size === 'number') {
            size = size / 8;
        }
        if (typeof size === 'number' || (typeof size === 'string' && /^[\d.]+$/.test(size))) {
            if (size < B) {
                size = Math.round(size) + 'B';
            } else if (size < K) {
                size = Math.round(size / B) + 'KB';
            } else if (size < M) {
                size = (size / K).toFixed(1) + 'M';
            } else if (size < LG) {
                size = (size / M).toFixed(1) + 'G';
            } else if (size < BG) {
                size = Math.round(size / M) + 'G';
            } else {
                size = Math.round(size / G) + 'T';
            }
        } else {
            size = '-';
        }
        size = size.replace('.0', '');
        return size;
    },

    getFirstWord: function (name) {
        if (name) {
            return name.substr(0, 1).toLocaleUpperCase();
        }
        return '';
    },

    getSearch: function (key) {
        return ((location.search || '').match(new RegExp('[?&]' + key + '=([^&]+)')) || [])[1] || '';
    },

    // 预览音频，未登录情况下引导登录
    makePreviewMusicLogin: function () {
        context.log.send({
            name: 'web_share_list_preview_music_dialog',
            value: {
                value: '外链未登录预览音频-引导登录弹窗展示',
            }
        });
        context.ui.tip({
            mode: 'caution',
            msg: '您还未登录，请登录后预览',
            sticky: false
        });
        window.yunHeader.login.util.loginNew();
        window.yunHeader.on('loginSuccess', function (args) {
            // 登录成功重新加载页面
            context.log.send({
                name: 'web_share_list_preview_music_login_succ',
                value: {
                    value: '外链未登录预览音频-引导登录成功',
                }
            });
            location.reload();
        });
    },
    // 企业权限
    ePermissions: {
        transfer: {
            code: 14,
            name: '外链转存'
        },
        createDir: {
            code: 5,
            name: '新建文件夹'
        }
    },
    // 企业可新建&可转存权限
    eAllPermissions: function () {
        return [this.ePermissions.transfer.code, this.ePermissions.createDir.code];
    },
    // @param {Array} permitOpList
    // @return {Boolean} 是否可转存
    eCanTransfer: function (permitOpList) {
        return permitOpList.indexOf(this.ePermissions.transfer.code) >= 0;
    },
    // @param {Array} permitOpList
    // @return {Boolean} 是否可新建文件夹
    eCanCreateDir: function (permitOpList) {
        return permitOpList.indexOf(this.ePermissions.createDir.code) >= 0;
    },
    getIconByExt: function (path) {
        var docReg = /(.*)\.(doc|docx|dot|dotx|rtf|ots|odm|odt)$/i;
        var xlsReg = /(.*)\.(xls|xlsx|xlt|xltx|ots|ods|csv)$/i;
        var singleReg = /(.*)\.(txt|pdf|apk|exe|psd|torrent|mmap|mm|xmind|numbers|pages|link|vsd)$/i;
        var pptReg = /(.*)\.(ppt|pptx|ppst|potx|pps|pot)$/i;
        // eslint-disable-next-line
        var htmlReg = /(.*)\.(vue|html|htm|xhtml|xml|sh|md|as|c|cpp|h|cs|asp|pas|diff|patch|erl|groovy|java|jsp|json|pl|php|py|rb|sass|scss|scala|sql|vb|less|lua|go|bat|wml|cc|ejs)$/i;
        var cssReg = /(.*)\.(css|less|sass)$/i;
        var jsReg = /(.*)\.(js|ts|jsx|tsx)$/i;
        var fontReg = /(.*)\.(eot|otf|fon|font|ttf|ttc|woff|woff2)$/i;
        var zipReg = /(.*)\.(zip|rar|7z|gz|tgz|tar)$/i;
        // eslint-disable-next-line max-len
        var musicReg = /(.*)\.(mp3|aac|wav|wma|amr|asf|asx|aac\+|eaac\+|mp2|ogg|aif|mpega|m4a|3gpp|ac3|ape|flac|m2a|ram)$/i;
        var cadReg = /(.*)\.(dwg|dxf|dwt|dwl|dwl2)$/i;
        var imageReg = /(.*)\.(jpg|jpeg|png|png8|png24|gif|svg|bmp|webp)$/i;
        var videoReg = /(.*)\.(mp4|flv|swf|fla|avi|flv|mpg|rm|mov|mkv|rmvb)$/i;
        var typeMap = {
            audio: musicReg,
            word: docReg,
            excel: xlsReg,
            single: singleReg,
            ppt: pptReg,
            html: htmlReg,
            css: cssReg,
            js: jsReg,
            font: fontReg,
            compress: zipReg,
            cad: cadReg,
            image: imageReg,
            video: videoReg
        };
        var icon = 'other';
        Object.keys(typeMap).some(function (key) {
            var reg = typeMap[key];
            if (reg.test(path)) {
                if (key === 'single') {
                    var types = path.split('.');
                    icon = types[types.length - 1];
                } else {
                    icon = key;
                }
                return true;
            }
        });
        return icon.toLowerCase();
    },
    operateShareListButtonStyle: function (that) {
        var selecedItems = that.getCheckedItems();
        if (!selecedItems.length) {
            return;
        }
        // 处理有云打印按钮后下载的的样式
        var fileName = selecedItems[0].server_filename;
        var fileExt = fileName.substring(fileName.lastIndexOf('.') + 1);
        var downloadBtn = $('.share-list .g-button.tools-share-V20-btn[title="下载"]');
        if (!downloadBtn.length) {
            return;
        }
        if (selecedItems.length === 1 && 'ppt,pptx,pdf,doc,docx'.indexOf(fileExt.toLowerCase()) > -1) {
             // 自己的链接
            if (window.locals.get('self')) {
                downloadBtn.addClass('first_btn').removeClass('last_btn').removeClass('hassep');
                downloadBtn[0].style.setProperty('border-top-right-radius', '');
                downloadBtn[0].style.setProperty('border-bottom-right-radius', '');
                return;
            }
            downloadBtn[0].style.setProperty('border-radius', '0', 'important');
        } else {
            if (window.locals.get('self')) {
                downloadBtn.addClass('first_btn').addClass('last_btn').removeClass('hassep');
                downloadBtn[0].style.setProperty('border-top-right-radius', '16px', 'important');
                downloadBtn[0].style.setProperty('border-bottom-right-radius', '16px', 'important');
                return;
            }
            downloadBtn.css({
                'border-radius': 'none'
            });
            downloadBtn[0].style.setProperty('border-radius', '');
        }
    },
    // 根据文件后缀获取文件icon
    getIconType: function (fileSuffix, isDir = false) {
        if (!fileSuffix) {
            return 'Grid_Misc';
        }
        var extname = fileSuffix.toLowerCase();
        var type;
        if (isDir) {
            type = 'Grid_Folder';
        } else {
            switch (true) {
                case Grid_Video.test(extname):
                    type = 'Grid_Video';
                    break;
                case Music.test(extname):
                    type = 'Grid_Audio';
                    break;
                case Grid_Picture.test(extname):
                    type = 'Grid_Picture';
                    break;
                case Grid_ZIP.test(extname):
                    type = 'Grid_ZIP';
                    break;
                case Grid_EXE.test(extname):
                    type = 'Grid_EXE';
                    break;
                case Grid_Apple.test(extname):
                    type = 'Grid_Apple';
                    break;
                case Grid_Android.test(extname):
                    type = 'Grid_Android';
                    break;
                case Grid_Text.test(extname):
                    type = 'Grid_Text';
                    break;
                case Grid_Excel.test(extname):
                    type = 'Grid_Excel';
                    break;
                case Grid_Word.test(extname):
                    type = 'Grid_Word';
                    break;
                case Grid_PPT.test(extname):
                    type = 'Grid_PPT';
                    break;
                case Grid_PDF.test(extname):
                    type = 'Grid_PDF';
                    break;
                case Grid_Visio.test(extname):
                    type = 'Grid_Visio';
                    break;
                case Grid_BT.test(extname):
                    type = 'Grid_BT';
                    break;
                case Grid_CAD.test(extname):
                    type = 'Grid_CAD';
                    break;
                case Grid_Keynote.test(extname):
                    type = 'Grid_Keynote';
                    break;
                case Numbers.test(extname):
                    type = 'Numbers';
                    break;
                case Pages.test(extname):
                    type = 'Pages';
                    break;
                case PanD.test(extname):
                    type = 'PanD';
                    break;
                default:
                    type = 'Grid_Misc';
                    break;
            }
        }
        return type;
    }
}; 
});
;define("disk-share:widget/system/errorMsg/errorMsg.js",function(a){var e=a("system-core:context/context.js").instanceForSystem,r={0:"成功","-1":"由于您分享了违反相关法律法规的文件，分享功能已被禁用，之前分享出去的文件不受影响。","-2":"用户不存在,请刷新页面后重试","-3":"文件不存在,请刷新页面后重试","-4":"登录信息有误，请重新登录试试","-5":"host_key和user_key无效","-6":"请重新登录","-7":"该分享已删除或已取消","-8":"该分享已经过期","-9":"访问密码错误","-10":"分享外链已经达到最大上限100000条，不能再次分享","-11":"验证cookie无效","-14":"对不起，短信分享每天限制20条，你今天已经分享完，请明天再来分享吧！","-15":"对不起，邮件分享每天限制20封，你今天已经分享完，请明天再来分享吧！","-16":"对不起，该文件已经限制分享！","-17":"文件分享超过限制","-21":"预置文件无法进行相关操作","-30":"文件已存在","-31":"文件保存失败","-33":"一次支持操作999个，减点试试吧","-32":"你的空间不足了哟","-70":"你分享的文件中包含病毒或疑似病毒，为了你和他人的数据安全，换个文件分享吧",2:"参数错误",3:"未登录或帐号无效",4:"存储好像出问题了，请稍候再试",108:"文件名有敏感词，优化一下吧",110:"分享次数超出限制，可以到“我的分享”中查看已分享的文件链接",114:"当前任务不存在，保存失败",115:"该文件禁止分享",112:'页面已过期，请<a href="javascript:window.location.reload();">刷新</a>后重试',9100:'你的帐号存在违规行为，已被冻结，<a href="/disk/appeal" target="_blank">查看详情</a>',9200:'你的帐号存在违规行为，已被冻结，<a href="/disk/appeal" target="_blank">查看详情</a>',9300:'你的帐号存在违规行为，该功能暂被冻结，<a href="/disk/appeal" target="_blank">查看详情</a>',9400:'你的帐号异常，需验证后才能使用该功能，<a href="/disk/appeal" target="_blank">立即验证</a>',9500:'你的帐号存在安全风险，已进入保护模式，请修改密码后使用，<a href="/disk/appeal" target="_blank">查看详情</a>',90003:"暂无文件夹管理权限"};e.extendErrorMsg(r)});
;define("disk-share:widget/system/fileOperate/fileCreateAndMove.js",function(e,t,i){function s(e,t,i,s,o){for(var a,c,l=[],p=null,f=0,h=t.length;h>f;f++)p=t[f].path,a=r.tools.baseService.parseDirPath(p),c=r.tools.baseService.parseDirFromPath(p),l.push({path:a,dest:i,newname:c});n.post("/api/filemanager?channel=chunlei&clienttype=0&web=1&opera="+e,{filelist:n.stringify(l)},s,"json").error(o)}function o(e,t,i,s,o,c){var l,p,f=r.tools.baseService.parseDirFromPath(e),h="";if(a.test(f))return h="文件名不能包含以下字符：<,>,|,*,?,,/",c(h),!1;if(f.length>0){for(p=0,l=0;p<f.length;p++)f.charCodeAt(p)<128?l++:l+=2;l>255&&(h="文件(夹)名称长度不能超过255字节",c(h))}else h="文件(夹)名称不能为空，请输入文件名称",c(h);h||n.post("/api/create?a=commit",{path:e,isdir:i,size:t,block_list:s?'["'+s+'"]':"[]",method:"post"},o,"json")}var n=e("base:widget/libs/jquerypacket.js"),r=e("system-core:context/context.js").instanceForSystem,a=/[\\\/:*?'<>|]/i;i.exports.createAndMoveTo=function(e,t,i,n){o(e,"",1,null,function(){setTimeout(function(){s("copy"+i,t,e,n)},1e3)})}});
;define("disk-share:widget/system/fileOperate/fileOperate.js",function(l,a,e){var r=l("base:widget/tools/tools.js"),d=l("system-core:context/context.js").instanceForSystem,i=d.pluginControl,m=i.Registry,n=i.BrokerData.getAllData().fileIcon;e.exports.getInfo=function(l,a,e,d,i,o){l=l||"";var c=l.substring(l.lastIndexOf("/")+1),t={fileName:c,name:r.toEntity(c)};if(d)return t.smallIcon="dir-multi-small",t.middleIcon="dir-multi-middle",t.largeIcon="dir-multi-large",t;if(a)return l.match(/^\/apps$/)?(t.smallIcon="dir-apps-small",t.largeIcon="dir-apps-large",t.middleIcon="dir-apps-middle",t.name="我的应用数据",t):l.match(/^\/百度云收藏$/)?(t.smallIcon="dir-cang-small",t.largeIcon="dir-cang-large",t.middleIcon="dir-cang-middle",t.name="我的收藏",t):l.match(/^\/来自PC的备份文件$/)?(t.smallIcon="dir-backup-small",t.largeIcon="dir-backup-large",t.middleIcon="dir-backup-middle",t):l.match(/^\/apps\//)||l.match(/^\/百度云收藏\//)||l.match(/^\/来自PC的备份文件\//)?(t.smallIcon="dir-app-small",t.largeIcon="dir-app-large",t.middleIcon="dir-app-middle",t):l.match(/^cardHolder/)?(t.smallIcon="dir-card-small",t.largeIcon="dir-card-large",t.middleIcon="dir-card-middle",t.name="我的卡包",t):l.match(/^shareHolder/)?(t.smallIcon="dir-share-small",t.largeIcon="dir-share-large",t.middleIcon="dir-share-middle",t.name="共享给我的文件夹",t):i?(t.smallIcon="dir-share-small",t.largeIcon="dir-share-large",t.middleIcon="dir-share-middle",t):(t.smallIcon="dir-small",t.largeIcon="dir-large",t.middleIcon="dir-middle",t);if(1===+o)return t.smallIcon="wp-small",t.largeIcon="wp-large",t.middleIcon="wp-middle",t;t.largeIcon="default-large",t.smallIcon="default-small",t.middleIcon="default-middle";var s=-1!==l.lastIndexOf(".")?r.getFileCategory(l):"*";n[s]&&(3===n[s].length?(t.smallIcon=n[s][0],t.largeIcon=n[s][1],t.middleIcon=n[s][2]):2===n[s].length?(t.smallIcon=n[s][0],t.largeIcon=n[s][1]):(t.smallIcon=n[s],t.largeIcon=n[s]));var g=m.getDefaultPluginIdByExtension(s);return!e&&g&&(g=m.getPluginById(g).name+"@"+m.getOtherInfoById(g).group),t.plugin=g,t};var o=["dir","multi","shouchang","yingyong","yingyong_child","beifen","doc","docx","xls","xlsx","ppt","pptx","pdf","txt","jpg","jpeg","gif","bmp","png","jpe","cur","svg","svgz","tif","tiff","ico","wma","wav","mp3","aac","ra","ram","mp2","ogg","aif","mpega","amr","mid","midi","m4a","wmv","rmvb","mpeg4","mpeg2","flv","avi","3gp","mpga","qt","rm","wmz","wmd","wvx","wmx","wm","swf","mpg","mp4","mkv","mpeg","mov","asf","zip","rar","torrent"];e.exports.isOpenedFile=function(l,a){return a&&"torrent"===l?!1:o.indexOf(l)>=0}});
;define("disk-share:widget/system/util/contextExtend.js",function(e){window.metaData={};var i=window.locals.get("file_list");if(i){var t=e("base:widget/tools/service/tools.format.js").toFriendlyFileSize,r=i[0]||{};window.metaData.file=r,window.metaData.FIRST_FILE_SIZE=r.size?t(r.size):0,window.metaData.FS_ID=r.fs_id+"",window.metaData.FILENAME=r.server_filename}var n=e("system-core:context/context.js").instanceForSystem,o=e("disk-share:widget/system/fileOperate/fileOperate.js"),s=e("disk-share:widget/system/fileOperate/fileCreateAndMove.js"),a=e("system-core:system/uiService/log/log.js"),l=n.ui.list;e("disk-share:widget/system/errorMsg/errorMsg.js"),n.extend({file:{getIconAndPlugin:function(e,i,t){return o.getInfo(e,i,!1,t)},isOpenedFile:function(e,i){return o.isOpenedFile(e,i)},getFileInfo:function(e,i,t,r,n){return o.getInfo(e,i,t,r,n)},createAndMoveTo:s.createAndMoveTo,getPreviewLinkInShare:function(e,i){if(e.newdocpreview)return i(null,e.newdocpreview);var t=window.location.pathname.split("/s/"),r="";t.length>1&&(r=decodeURIComponent(localStorage.getItem(t[1]+"_bdclnd")||"")),$.ajax({url:"/share/list",data:{is_from_web:!!r,sekey:r,uk:window.locals.get("share_uk"),shareid:window.locals.get("shareid"),web:1,newdocpreview:1,fid:e.fs_id},dataType:"json",success:function(t){0===t.errno?(e.newdocpreview=t.list[0].newdocpreview,i(null,e.newdocpreview)):i(new Error("meet some error"))},error:function(e){i(new Error(e))}})}},ui:{list:function(e,i){var t=l(e,i);return t.extend({resizeScrollBar:function(e){var i=this.$container;if("number"==typeof e||"string"==typeof e?i.height(e):e=i.height(),0===e)throw"[Error] list container's height is 0, need to set";i.height(e);var t=this.listHeader.hasInit===!1?0:52;"none"===i.find(".JDeHdxb").css("display")?(i.find(".NHcGw").height(e-t).find(".scrollbar-tracker").height(e-t-2),i.find(".BNfIyPb").height(e-t).find(".scrollbar-tracker").height(e-t-2)):(i.find(".NHcGw").height(e-73).find(".scrollbar-tracker").height(e-73),i.find(".BNfIyPb").height(e-73).find(".scrollbar-tracker").height(e-73))}}),t}},pageInfo:{currentProduct:"share",currentPage:"share-multi"}}),window.locals.get("Elink_info",function(e){e&&e.isElink&&a.extendDefaultParams({sourceFrom:"enterprise_web_sharelink"})})});
;define("disk-share:widget/system/util/logs/agentLog.js",function(e,o,n){function a(e,o){if(o||(o={}),e){var n=t[e];n.ext=o,i.sendLog(n)}}var t={commonBase:{serverId:19071,from:"video",page:"agent_connection",parasitifer:"web",appname:"wangpan"},codePageShow:{type:"display",value:"code",comment:"web外链输入提取码页展现"},codeSuccessPageShow:{type:"display",value:"detail",comment:"web外链提取码成功展现"},sharepageClickDownload:{type:"click",value:"topc",comment:"外链点击下载"}},c=window.BpData;c||(c=function(){},c.prototype.sendLog=function(){});var i=new c(t.commonBase);n.exports.sendlog=function(e,o){setTimeout(function(){a(e,o)},0)}});
;define("disk-share:widget/system/util/getAdList/fetchAjax.js",function(e,t,i){function s(e,t,i,s){var n=d(a+e+t+i.request_id+i.list[0].id);return e+";"+i.request_id+";"+i.list[0].id+";"+s+";"+n}var n=e("base:widget/libs/jquerypacket.js"),d=e("disk-share:widget/system/util/getAdList/MD5.js"),a="3c27ad3f861ecfd7";i.exports=function(e,t,i,r){var c=0,u=t.list,o=e||"/rest/2.0/pcs/adx",g={},l=function(e,i,r){if(c>u.length-1)return void e({errno:0,data:r});var g=(new Date).getTime(),f=u[c].id,v=d(a+g+f),j={m:"pos",d:"web",p:f,s:g+";"+v,uk:t.uk||window.locals.get("uk"),time:g},p=n.extend({},j,u[c]);n.ajax({type:"GET",url:o,dataType:"json",data:p,success:function(t){r[f]=n.extend({},t),t.list&&(r[f].csign=s(g,f,t,"c"),r[f].vsign=s(g,f,t,"v")),c++,l(e,i,r)},error:function(t){r[f]=n.extend({},t),t.list&&(r[f].csign=s(g,f,t,"c"),r[f].vsign=s(g,f,t,"v")),c++,l(e,i,r)}})};l(i,r,g)}});
;define("disk-share:widget/system/util/adPlatform/adPlatform.tpl.js",function(i,t,a){var n={alljs:["<%= content %>"].join(""),singletext:["<%for(var i=0; i < info.length; i++){%>","<% var item = info[i]%>","<% if (item.ad_warn) {%>",'<sapn class="ad-warn">',"<%- item.ad_warn %>","</sapn>","<%}%>","<% if (item.close) {%>",'<sapn class="ad-close">close</sapn>',"<%}%>",'<a target="<%- isTarget(item.action.action)%>"href="<%- item.action.action %>" title="<%- item.content %>">',"<%- item.content %>","</a>","<%}%>"].join(""),singleimage:["<%for(var i=0; i < info.length; i++){%>","<% var item = info[i]%>","<% if (item.ad_warn) {%>",'<sapn class="ad-warn">',"<%- item.ad_warn %>","</sapn>","<%}%>","<% if (item.close) {%>",'<sapn class="ad-close">close</sapn>',"<%}%>",'<a target="<%- isTarget(item.action.action)%>"href="<%- item.action.action %>" title="<%- item.action.param.title %>"',' style="background:url(<%- item.content %>) center no-repeat;height:<%- imgs %>;display:block;">',"</a>","<%}%>"].join(""),multiimage:["<%for(var i=0; i < info.length; i++){%>","<% var item = info[i]%>",'<a target="<%- isTarget(item.action.action)%>"href="<%- item.action.action %>" title="<%- item.action.param.title %>"',' style="display:block;position:absolute;width: 898px;left: 50%;margin-left: -449px;">','<img src="<%- item.content %>" class="share-center" />',"<% if (item.ad_warn) {%>",'<sapn class="ad-warn">',"<%- item.ad_warn %>","</sapn>","<%}%>","<% if (item.close) {%>",'<sapn class="ad-close">close</sapn>',"<%}%>","</a>","<%}%>"].join(""),video:["<video>",'<source src="<%- info.content %>">',"</video>"].join(""),wangmengAside:['(window["cproStyleApi"] = window["cproStyleApi"] || {})','[ "u2380627" ]={at:"3",rsi0:"200",rsi1:"200",pat:"17",tn:"baiduCustNativeAD",','rss1:"#FFFFFF",conBW:"1",adp:"1",ptt:"0",','titFF:"%E5%BE%AE%E8%BD%AF%E9%9B%85%E9%BB%91",','titFS:"",rss2:"#000000",titSU:"0"};',"(window.cproArray = window.cproArray || []).push({",'id: "u2380627"',"});"].join(""),wangmengSingle:["(window.cproArray = window.cproArray || []).push({",'id: "u2493175"',"});"].join(""),wangmengBottom:["(window.cproArray = window.cproArray || []).push({",'id: "u2164871"',"});"].join("")};a.exports=n});
;define("disk-share:widget/system/util/adPlatform/adPlatformService.js",function(e,t,a){var n=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/libs/underscore.js"),r=e("system-core:context/context.js").instanceForSystem,o=e("disk-share:widget/system/util/adPlatform/adPlatform.tpl.js"),d={init:function(){d.dealWithAdShow(),d.eventInit()},getFirstItemByNodeId:function(e){return(d.data[e].list||[])[0]||{}},dealWithAdShow:function(){var e=this;i.each(d.data,function(t,a){if(e.checkAd(t))return void(("web-sharelinkpic"===a||"web-sharesinglebanner"===a||"web-sharemultibanner"===a)&&e.createScript(a));var n=t.list&&t.list[0]?t.list[0].type.toLowerCase():"image";d.dealSingleAd(a,n)}),n(".ad-platform-tips").is(":visible")&&r.message.trigger("ad-share-list-single-show")},checkAd:function(e){return null===e||e&&e.error_code},createScript:function(e){var t=document.createElement("div"),a=document.createElement("script"),n=document.createElement("script");if(""===a.innerHTML||""===a.innerHTML)return!1;var i={"web-sharelinkpic":{shareIdStr:"web-right-view",uid:"u2380627",shareTpl:"wangmengAside"},"web-sharesinglebanner":{shareIdStr:"web-single-bottom",uid:"u2493175",shareTpl:"wangmengSingle"},"web-sharemultibanner":{shareIdStr:"web-multi-bottom",uid:"u2164871",shareTpl:"wangmengBottom"}},r=document.getElementById(i[e].shareIdStr||"web-right-view");a.innerHTML=o[i[e].shareTpl||"wangmengAside"],a.type=n.type="text/javascript",n.src=window.location.protocol+"//cpro.baidustatic.com/cpro/ui/c.js",t.id="cpro_"+(i[e].uid||"u2380627"),r.appendChild(t);var d=document.getElementById("cpro_"+(i[e].uid||"u2380627"));d.appendChild(a),d.appendChild(n),a=null,n=null},formatHTTP:function(e){return i.isArray(e)&&e.length>0&&e[0].content?e[0].content=e[0].content.replace(/https?:/gi,window.location.protocol):i.isString(e)&&(e=e.replace(/https?:/gi,window.location.protocol)),e},dealSingleAd:function(e,t){var a="",r=n('.ad-platform-tips[node-id~="'+e+'"]');if("js"===t){var s=d.getFirstItemByNodeId(e);if("baichuan"===s.uid){var l="";l="web-sharemultibanner"===e?['<div style="margin: 0 auto; width: 960px;">',d.base64decode(s.content),"</div>"].join(""):d.base64decode(s.content),r.html(l)}else{t="all"+t;var c=document.createElement("div"),p=document.createElement("script"),u=document.createElement("script");u.type="text/javascript",u.src=window.location.protocol+"//cpro.baidustatic.com/cpro/ui/c.js";var h=i.template(o[t])({content:d.base64decode(s.content)});c.id="cpro_"+(s.uid||"u2380627"),"web-sharemultibanner"===e&&(c.style="margin: 0 auto; width: 960px;"),p.innerHTML=h,r.append(c);var m=n("#cpro_"+(s.uid||"u2380627"));m.append(p),m.append(u),p=null,u=null}}else{"web-sharemultibanner"===e?(t="multi"+t,a=d.data["web-sharelinkrepeat"].list?d.formatHTTP(d.data["web-sharelinkrepeat"].list[0].content):null):(t="single"+t,a="web-sharelinkpic"===e?"200px":"90px");var h=i.template(o[t])({info:d.formatHTTP(d.data[e].list)||[],imgs:a,isTarget:function(e){return-1!==["#","javascript:;","javascript:void(0);"].indexOf(e)?"":"_blank"}});r.append(h)}this.sendViewCallback(e)},eventInit:function(){d.adPlatformTips.on("click",function(e){if(n(e.target).hasClass("ad-close"))n(e.target).parents(".ad-platform-tips").hide(),e&&e.preventDefault(),r.log.send({type:"web_ad_click_close"});else{var t=n(this).attr("node-id");d.sendClickCallback(t)}})},base64decode:function(e){var t,a,n,i,r,o,d,s=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(o=e.length,r=0,d="";o>r;){do t=s[255&e.charCodeAt(r++)];while(o>r&&-1===t);if(-1===t)break;do a=s[255&e.charCodeAt(r++)];while(o>r&&-1===a);if(-1===a)break;d+=String.fromCharCode(t<<2|(48&a)>>4);do{if(n=255&e.charCodeAt(r++),61===n)return d;n=s[n]}while(o>r&&-1===n);if(-1===n)break;d+=String.fromCharCode((15&a)<<4|(60&n)>>2);do{if(i=255&e.charCodeAt(r++),61===i)return d;i=s[i]}while(o>r&&-1===i);if(-1===i)break;d+=String.fromCharCode((3&n)<<6|i)}return d},sendCallback:function(e,t){var a=(new Date).getTime()+e;window[a]=new Image;var n=window[a];if(e){var i=0,r=0;switch(e){case"web-sharelinkpic":i=200,r=200;break;case"web-sharemultibanner":r=910,i=90;break;case"web-sharesinglebanner":r=710,i=90;break;default:return}var o="&h="+i+"&w="+r+"&p="+(e||"web-text")+"&s="+encodeURIComponent(t),d=window.host&&window.host.HOST_PAN||"pan.baidu.com",s="//"+d+"/rest/2.0/pcs/adx?m=callback"+o;n.onload=n.onerror=function(){window[a]=null},n.src=s,n=null}},sendViewCallback:function(e){var t=d.getFirstItemByNodeId(e);r.log.send({type:"web_show_"+(t.id||"")}),this.sendCallback(e,d.data[e].vsign)},sendClickCallback:function(e){var t=d.getFirstItemByNodeId(e);r.log.send({type:"web_click_"+(t.id||"")}),this.sendCallback(e,d.data[e].csign)}};a.exports.init=function(e){e||(e={}),d.data=e.data||{},d.adPlatformTips=e.AdPlatformTips||{},d.init()}});
;define("disk-share:widget/system/singleFileComment/singleFileComment.js",function(e){var n=e("base:widget/libs/jquerypacket.js");window.locals.get("pansuk","share_uk","shareid",function(o,s,t){var a={source_uk:s,source_id:t,type:0,avatar_url:window.locals.get("photo"),uname:window.locals.get("username"),current_uk:window.locals.get("uk"),pansuk:o,login_status:window.locals.get("loginstate"),domType:1,limit:20,dialog:{hasBorder:!1,hasArraw:!1,hasScroll:!1},onLoadedCallBack:function(){disk.DEBUG&&console.log("loaded comment successed!")},onrefreshPage:function(){disk.DEBUG&&console.log("loaded comment successed ~~~!")},onLoadedTextarea:function(){}},l=n(".comment_panel");e.async("disk-share:widget/system/singleFileComment/commentPanel/commentPanel.js",function(e){var o=new e;o.startInit(l,a),o.getTotalCount=function(e){var o=e>999?"999+":e;n(".funcs-comment").text("评论("+o+")")}})})});
;define("disk-share:widget/system/util/adPlatform/adPlatform.js",function(t,i,a){"use strict";var o=t("base:widget/libs/jquerypacket.js"),r=t("disk-share:widget/system/util/adPlatform/adPlatformService.js"),e=t("disk-share:widget/system/util/getAdList/fetchAjax.js"),n=function(){this.AdPlatformTips=o(".ad-platform-tips"),this.config={},this.errorCount=0,this.data={}};n.prototype={getAdResoucre:function(t,i,a){var o=this;t||(t={list:[{id:"web-text",w:0,h:0}]}),t.uk=window.locals.get("uk"),o.data=t,e("/rest/2.0/pcs/adx",t,function(t){t?(i&&"function"==typeof i&&i.call(o,t),o.configInitData(t)):(o.errorCount++,a&&"function"==typeof a&&a.call(o,t),o.errorCallback(t))},function(t){o.errorCount++,a&&"function"==typeof a&&a.call(o,t),o.errorCallback(t)})},configInitData:function(t){this.config.data=t.data,this.config.AdPlatformTips=this.AdPlatformTips,r.init(this.config)},errorCallback:function(t){var i=this;t&&0!==t.errno&&1===i.errorCount&&(i.getAdResoucre(i.data),i.data=null)}},n.init=function(){return new n},a.exports=new n});
;define("disk-share:widget/system/util/getCookies.js",function(e,t,i){i.exports=function(e){for(var t=document.cookie.split(";"),i=0;i<t.length;i++){var o=t[i].split("=");if(o[0].trim()===e)return decodeURIComponent(o[1])}}});
;define("disk-share:widget/pageModule/share-file-main/fileType/picture/Rotater.js",function(t,i,e){var a=t("base:widget/libs/jquerypacket.js"),o=function(t,i){if(!(this instanceof o)){var e=new o(t,i);return e}this.init(t,i)};o.prototype.init=function(t,i){this.rotaterBox=a(t),this.image=this.rotaterBox.find("img"),this.leftButton=a(".left"+i.slice(1)),this.rightButton=a(".right"+i.slice(1)),this._setupData(),this._style(),this._bindEvent(i)},o.prototype._setupData=function(){this.leftButton.data("dir","-1"),this.rightButton.data("dir","1"),this.rotation=1,this.containerWidth=this.rotaterBox.width(),this.containerHeight=this.rotaterBox.height()},o.prototype._style=function(){this.rotaterBox.addClass("poorRotaterBox"),"absolute"!==this.rotaterBox[0].style.position&&(this.rotaterBox[0].style.position="relative"),this.imageStylePrefix=a.browser.msie&&parseInt(a.browser.version,10)<9?"ie":"",this.image.addClass(this.imageStylePrefix+"poorRotater-1"),this.image.animate({marginTop:this.image.height()/-2,marginLeft:this.image.width()/-2},function(){a(this).css("visibility","visible")})},o.prototype._bindEvent=function(t){var i=this;a(t).bind("click",function(){var t=parseInt(a(this).data("dir"),10),e=(i.rotation+t)%4,o=i.image.width(),s=i.image.height();0>=e&&(e+=4),i.image.removeClass(i.imageStylePrefix+"poorRotater-"+i.rotation).addClass(i.imageStylePrefix+"poorRotater-"+e),i.image.css(e%2===0&&o>i.containerHeight&&o>s?{width:i.containerHeight,height:"auto"}:{width:"auto",height:"auto"}),i.rotation=e,o=i.image.width(),s=i.image.height(),i.image.css({marginTop:s/-2,marginLeft:o/-2})})},e.exports=o});
;define("disk-share:widget/system/util/log.js",function(e,t,a){function l(e,t){if(t||(t={}),e){var a=n[e];a.ext=t,o.sendLog(a)}}var n=(e("base:widget/libs/underscore.js"),{commonBase:{serverId:19005,from:"video",page:"video_view_page",parasitifer:"web",appname:"wangpan"},videoPlayerDis:{type:"display",value:"video_player_dis",comment:"视频播放器展现"},tryPalyDis:{type:"display",value:"try_paly_dis",comment:"试看保存浮条展现"},tryPalyClk:{type:"clk",value:"try_paly_clk",comment:"试看保存浮条点击"},tryPalyCloseClk:{type:"clk",value:"try_paly_close_clk",comment:"试看保存浮条点击关闭"},tryEndDis:{type:"display",value:"try_end_dis",comment:"播放结束按钮展现"},tryEndSaveClk:{type:"display",value:"try_end_save_clk",comment:"播放结束点击保存"},tryEndReplayClk:{type:"display",value:"try_end_replay_clk",comment:"播放结束点击重新播放"}}),y=window.BpData;y||(y=function(){},y.prototype.sendLog=function(){});var o=new y(n.commonBase);a.exports.sendlog=function(e,t){setTimeout(function(){l(e,t)},0)}});
;define("disk-share:widget/pageModule/share-file-main/fileType/other.js",function(e){function i(e){return""===e?"":e.match(/([^\.]+)$/)[1].toLowerCase()}var n=e("system-core:context/context.js").instanceForSystem,o=e("base:widget/libs/jquerypacket.js"),a=e("base:widget/libs/underscore.js"),s={node:{fileInfo:'[node-type="share-info-box"]',unzipBox:"span.unzip-box",fileOpenBtn:'[node-type="info-open-button"]'},tmpl:{zip:['<a class="fileicon" node-type="info-open-button" href="javascript:;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>','<div class="unzip-box-bar"><span class="unzip-box" node-type="info-open-button"></span></div>',"</div>"].join(""),other:['<a class="fileicon" href="javascript:;" style="cursor: default;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>',"</div>"].join("")},classify:function(){var e=(n.list.getSelected()||[])[0]||{},o=i(e.server_filename);"zip"===o||"rar"===o?(e.fileType="zip",n.log.send({name:"web_link_share_preview_action",value:{value:"预览zip",category:8}}),s.excuteZip(e)):s.checkIsCode(o)?(e.fileType="code",s.excuteCode(e)):(e.fileType="other",s.renderStyle(e))},checkIsCode:function(e){if(!e)return!1;var i=a.find(window.manifest,function(e){return"网盘代码阅读器"===e.name});return i?i.filesType.indexOf(e)>-1:!1},excuteZip:function(e){s.renderStyle(e);var i={type:"big",color:"blue",title:"打开压缩包",resize:!0};n.ui.button(i).appendTo(o(s.node.unzipBox)),s.node.fileInfoNode.delegate(s.node.fileOpenBtn,"click",function(){n.message.callPlugin("网盘解压缩@com.baidu.pan",{filesList:[e]})})},excuteCode:function(e){var i=s.node.fileInfoNode=o(s.node.fileInfo);n.message.callPlugin("网盘代码阅读器@com.baidu.pan",{filesList:e,dom:i,onerror:function(){var e=['<div class="doc-view-failed">','<div class="doc-view-failed-img" style="display: block;">','<div class="doc-view-failed-txt">啊哦，预览不成功啊，下载下来看吧</div>',"</div>",'<div class="cb"></div>',"</div>"].join("");i.html(e)}})},renderStyle:function(e){var i=n.tools.baseService.toFriendlyFileSize(e.size),t=n.file.getFileInfo(e.path,e.isdir,!1,!1,!0).largeIcon,l=a.template(s.tmpl[e.fileType],{variable:"info"})({fileQuota:i}),d=s.node.fileInfoNode=o(s.node.fileInfo);d.append(l).addClass("share-info-default").find(".fileicon").addClass(t)}};s.classify()});
;define("disk-share:widget/pageModule/share-file-main/fileType/document.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),a=e("system-core:context/context.js").instanceForSystem,s=i('[node-type="share-info-box"]'),l=(a.list.getSelected()||[])[0]||{};a.log.send({name:"web_link_share_preview_action",value:{value:"外链分享页文档预览",category:4,subType:"preview"}}),a.message.callPlugin("网盘文档阅读器@com.baidu.pan",{filesList:l,dom:s,onerror:function(){a.log.send({name:"web_link_share_preview_action",value:{value:"外链分享页文档预览失败",category:4,subType:"fail"}});var e=['<div class="doc-view-failed">','<div class="doc-view-failed-img" style="display: block;">','<div class="doc-view-failed-txt">',"啊哦，预览不成功啊，下载下来看吧","</div>","</div>",'<div class="cb"></div>',"</div>"].join("");s.html(e)}})});
;define("disk-share:widget/pageModule/share-file-main/fileType/bt.js",function(e){var i=e("system-core:context/context.js").instanceForSystem,s=e("base:widget/libs/jquerypacket.js"),a=e("base:widget/libs/underscore.js"),t=a.template(['<a class="fileicon" node-type="info-open-button" href="javascript:;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>','<div class="bt-box-bar"><span class="bt-box" node-type="bt-open-button"></span></div>',"</div>"].join(""),{variable:"info"}),n=(i.list.getSelected()||[])[0]||{},o=i.tools.baseService.toFriendlyFileSize(n.size),l=i.file.getFileInfo(n.path,n.isdir,!1,!1,!0).largeIcon,d=t({fileQuota:o});s('[node-type="share-info-box"]').append(d).addClass("share-info-default").find(".fileicon").addClass(l)});
;define("disk-share:widget/pageModule/share-file-main/fileType/application.js",function(e){var i=e("system-core:context/context.js").instanceForSystem,s=e("base:widget/libs/jquerypacket.js"),a=e("base:widget/libs/underscore.js"),t=a.template(['<a class="fileicon" href="javascript:;" style="cursor: default;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>',"</div>"].join(""),{variable:"info"}),l=(i.list.getSelected()||[])[0]||{},o=i.tools.baseService.toFriendlyFileSize(l.size),n=i.file.getFileInfo(l.path,l.isdir,!1,!1,!0).largeIcon,d=t({fileQuota:o});s('[node-type="share-info-box"]').append(d).addClass("share-info-default").find(".fileicon").addClass(n)});
;define("disk-share:widget/pageModule/share-file-main/fileType/picture/picture.js",function(e){function t(e){var t=a(e.parentNode.parentNode);e.style.height="auto",e.style.width="auto";var i=e.naturalWidth||e.width,r=e.naturalHeight||e.height;if(i>t.width()||r>t.height()){var n=t.width()>t.height();n?e.style.height="100%":e.style.width="100%"}}var i=e("system-core:context/context.js").instanceForSystem,a=e("base:widget/libs/jquerypacket.js"),r=e("disk-share:widget/pageModule/share-file-main/fileType/picture/Rotater.js"),n={conf:{},q:{mod:".module-share-file-main",picFileDetail:".picture-file-detail",picContainer:".picContainer",rotateBar:".rotateBar"},init:function(e){var n=this,o=a(n.q.mod),s=function(){var e=document.getElementById("viewFailed");e.style.display="block",o.find(n.q.picFileDetail).css("background","#efefef"),o.find(n.q.picContainer).remove(),o.find(n.q.rotateBar).remove()};if(!e)return void s();var d=document.getElementById("rotateImage"),l=e.replace("c850_u580","c710_u400");d&&(d.onload=function(){t(d),a(".picture-file-detail").mouseenter(function(){a(".rotateBar").show()}).mouseleave(function(){a(".rotateBar").hide()}),r("#rotateContainer",".RotaterBtn"),i.log.send({type:"picpreview_successed_analyties",sendPageFrom:!0,from_uk:window.locals.get("share_uk")})},d.onerror=s,d.src=l)}},o=(i.list.getSelected()||[])[0]||{};n.init(o.thumbs.url3)});
;define("disk-share:widget/pageModule/share-file-main/fileType/music/music.js",function(e){var i=e("system-core:context/context.js").instanceForSystem;i.log.send({name:"web_link_share_preview_action",value:{value:"外链分享页音频播放",category:2}}),i.message.callPlugin("网盘音频播放器@com.baidu.pan",{filesList:window.locals.get("file_list"),inDialog:!1})});
;define("disk-share:widget/pageModule/share-file-main/fileType/video/video.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),a=e("base:widget/vip/vip.js"),r=e("system-core:context/context.js").instanceForSystem,t=e("base:widget/storage/storage.js"),s=e("disk-share:widget/system/util/elinkThemeRender.js"),o=e("file-widget-1:videoPlay/utils/video-level.js"),n=r.message,l=(1===window.locals.get("loginstate"),"transfer_files_"+window.locals.get("uk")),d=e("disk-share:widget/system/util/log.js"),c={node:{container:"#video-wrap",mod:"#video-wrap-outer",startTip:".video-start-tip",replayBtn:".replay-btn",saveToPan:".save-to-pan"},vars:{hasTransfered:!1,shareFileId:window.metaData.FS_ID+"@"+window.locals.get("uk")+",",previewTime:30,resolveFileInDiskStatus:0,isViewAllVideo:!1,videoLogParam:{}},callPlugin:function(){var e=(r.list.getSelected()||[])[0]||{},t=window.locals.get("file_list"),l={},v="";if(t&&t.length>0){for(var f=0;f<t.length;f++)if(t[f].fs_id===e.fs_id){l=t[f];break}v=t[0].server_filename+(t.length>1?"等":"")}c.vars.videoLogParam={user_type:2===a.getVipValue()?"svip":0===a.getVipValue()?"norm":"other",is_login:0!==e.uk?1:0,share_id:window.locals.get("shareid"),share_name:v,link_share_uk:window.locals.get("share_uk"),fsid:l.fs_id||e.fsid||"",md5:l.md5||"",file_name:l.server_filename||e.fileName||"",file_path:l.path||""},window.locals.get("sign","timestamp","share_uk","shareid","Elink_info","Espace_info",function(t,l,v,f,p,u){c.vars.isViewAllVideo=c.checkCertLinkStatus(p,u);var g={file:e,container:i(c.node.container),flag:"sharevideo",rememberPosition:!1,autoplay:!0,werbung:window.locals.get("self"),getUrl:function(i){return location.protocol+"//"+location.host+"/share/streaming?channel=chunlei&uk="+v+"&fid="+e.fs_id+"&sign="+t+"&timestamp="+l+"&shareid="+f+"&type="+i+"&vip="+a.getVipValue()+"&jsToken="+window.jsToken},callback:function(a){c.player=a,c.checkInDisk()||s.getTransferAndDownloadStatus(function(a){!a.cantTransfer&&!a.cantDownload&&e.duration>c.vars.previewTime&&(i(c.node.mod).find(".video-start-tip").show(),d.sendlog("tryPalyDis",c.vars.videoLogParam))}),1===p.isElink&&i(c.node.mod).find(".video-start-tip").hide()},onBeforePlay:function(){return!0},onPlay:function(){r.log.send({name:"web_link_share_preview_action",value:{value:"外链分享页视频播放",category:1}})},onPause:function(){},onBeforeDestroy:function(){return!0},onTimeUpdate:function(e,i){c.checkNotOver(e,i)}},m={url:location.protocol+"//update.pan.baidu.com/statistics",type:"vast_player_user_number",op:"vast_player_user_number",isvip:a.getVipValue(),value:JSON.stringify({netdisk_user_number:{media_source:"801",file_md5:e.md5||"",media_from:"sharevideo"}})};d.sendlog("videoPlayerDis",c.vars.videoLogParam),o.getLevel("videopreview_share").then(function(e){g.useNewSDK=e.value,n.callPlugin("网盘视频播放器@com.baidu.pan",g),m.useNewSDK=g.useNewSDK,r.log.send(m)})})},checkNotOver:function(e){var i=c.vars||{};return i.hasTransfered||window.locals.get("self")?!0:i.isViewAllVideo?!0:void c.videoRunLimit(e)},videoRunLimit:function(e){if(e>c.vars.previewTime){var a=i(c.node.mod);c.player.pause(),a.find(".video-start-tip").hide(),a.find(".video-overlay-iframe").show(),s.getTransferAndDownloadStatus(function(e){e.cantTransfer||e.cantDownload||("none"===a.find(".video-over-tip").css("display")&&d.sendlog("tryEndDis",c.vars.videoLogParam),a.find(".video-over-tip").show())})}},checkInDisk:function(){if(1!==+window.locals.get("loginstate"))return!1;if(window.locals.get("self"))return!0;var e=(r.list.getSelected()||[])[0]||{},i=JSON.parse(localStorage.getItem(l))||[];return-1!==i.indexOf(e.fs_id)?(c.vars.hasTransfered=!0,!0):!1},checkCertLinkStatus:function(e,i){if(e&&1===e.isElink&&i){var a=i.Espace_cert_status||0,r=i.Espace_op_status||0,t=i.Espace_product_status,s=i.Espace_product_type,o=0===a&&0===r,t=t,n=enterpriseProductBase.check("supportUnlimitedVideoPreview",{productType:s}),l=0===n.code&&n.value;return o&&0===t&&l}return!1},playError:function(e,a,r){var t=i(c.node.container);t.addClass("error-tips"),t.html('<div class="tip">'+(a?'<i class="tip-fail"></i>':"")+'<span class="tip-txt">'+e+(r?'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0);">重试</a>':"")+"</span></div>"),r&&t.find("a").click(function(){c.callPlugin()})},events:function(){var e=i(c.node.mod);i("#layoutHeader").css({zIndex:41}),e.find(".video-start-tip").on("click",".close-btn",function(){e.find(".video-start-tip").hide(),d.sendlog("tryPalyCloseClk",c.vars.videoLogParam)}),e.find(".save-to-pan").on("click",function(e){var i=(r.list.getSelected()||[])[0]||{};n.trigger("plugin:保存到网盘@com.baidu.pan.share",{filesList:[i]}),c.rememberTreansfer(),e.target.classList.length>1?d.sendlog("tryEndSaveClk",c.vars.videoLogParam):d.sendlog("tryPalyClk",c.vars.videoLogParam)}),e.find(".replay-btn").on("click",function(){e.find(".video-over-tip").hide(),e.find(".video-overlay-iframe").hide(),c.callPlugin(),d.sendlog("tryEndReplayClk",c.vars.videoLogParam)}),n.listen("share-video-after-transfer",function(){c.rememberTreansfer(),e.find(".video-start-tip").hide(),"block"===e.find(".video-overlay-iframe").css("display")&&(e.find(".video-overlay-iframe").hide(),e.find(".video-over-tip").hide(),c.player&&c.player.play())})},rememberTreansfer:function(){var e=t.getItem("panTransferedFile");e=e?e:"",-1===e.indexOf(c.vars.shareFileId)&&t.setItem("panTransferedFile",e+c.vars.shareFileId);var i=(r.list.getSelected()||[])[0]||{},a=JSON.parse(localStorage.getItem(l))||[];-1!==a.indexOf(i.fs_id)&&(c.vars.hasTransfered=!0)}};c.events(),window.locals.get("file_list","shareid",function(e,i){e[0]&&i?c.callPlugin():(c.playError("文件不存在，加载失败",!0,!1),r.log.send({type:"web_video_play_error",isvip:a.getVipValue(),from:400001,flag:"sharevideo"}),r.log.send({url:location.protocol+"//update.pan.baidu.com/statistics",type:"vast_player_play_error",op:"vast_player_play_error",isvip:a.getVipValue(),value:JSON.stringify({netdisk_get_mdedia_info_play_error:{video_info:{media_source:"801",media_from:"sharevideo"},error_info:{player_error:{system_time:+new Date,error_code:400001}}}})}))})});
;define("disk-share:widget/pageModule/share-person-info/service/adPanLog.js",function(e){var n=e("base:widget/libs/jquerypacket.js"),i=e("system-core:context/context.js").instanceForSystem,a={isOnIframe:!1,type:"",log:{view:function(e){n(window).load(function(){i.log.send({name:"sharePage_AD_plan_"+e+"_show"})})},click:function(e,o){e.find("iframe").hover(function(){a.isOnIframe=!0},function(){a.isOnIframe=!1}),n(window).blur(function(){a.isOnIframe&&i.log.send({name:"sharePage_AD_plan_"+o+"_click"})})},adClick:function(e,n){e.on("click",function(){i.log.send({name:"sharePage_AD_plan_"+n+"_click"})})}}},o=function(){var e=n("#share-ad-box"),i=n('.ad-multi-tips[node-type="share-mutil-bottom"]'),o=e.attr("type")||4,t=i.attr("type")||"";a.log.view(o),a.log.view(t),a.log.click(e,o),a.log.adClick(i,t)};o()});
;define('disk-share:widget/pageModule/share-header/subscribe-outside-link.js', function(require, exports, module){ /**
 * @file 外链订阅
 * @author: chenchubo@baidu.com
 */

var $ = require('base:widget/libs/jquerypacket.js');
var context = require('system-core:context/context.js').instanceForSystem;

var dialog;

var pri = {
    conf: {
        shortUrlData: '',
        hasSubscribed: false
    },
    api: {
        querySubscribApi: '/share/subscribe?method=query',
        addSubscribeApi: '/share/subscribe?method=add',
        cancelSubscribeApi: '/share/subscribe?method=cancel'
    },
    util: {
        getAutoSubStatus: function () {
            var nodeKey = 'sharelink_wap_config';
            var configKey = "sharelink_auto_sub_config";
            try {
                $.ajax({
                    url: '/api/getsyscfg',
                    type: 'get',
                    dataType: 'json',
                    data: {
                        cfg_category_keys: JSON.stringify([{
                            'cfg_category_key': nodeKey,
                            'cfg_version': 0
                        }]),
                        clienttype: 0,
                        version: '1.0.0'
                    },
                    success: function (res) {
                        if (!res || res.errno !== 0 || !res.sharelink_wap_config) {
                            return;
                        }
                        var cfglist = res.sharelink_wap_config.cfg_list;
                        if (!cfglist || !cfglist.length) {
                            return;
                        }
                        for (var i = 0; i < cfglist.length; i++) {
                            var fileInfo = cfglist[i];
                            if (fileInfo && fileInfo.node_key === configKey && fileInfo.sharelink_auto_sub_smallow_config) {
                                window.locals.set('trans_auto_sub_status', fileInfo.sharelink_auto_sub_smallow_config);
                            }
                        }
                    }
                });
            } catch (error) {
                console.log(error);
            }
        },
        getSekey: function () {
            var sPath = window.location.pathname.split('/s/');
            var result = '';
            if (sPath.length > 1) {
                var sekey = localStorage.getItem(sPath[1] + '_bdclnd') || '';
                if (sekey) {
                    result = sekey;
                }
            }
            return result;
        },
        // 查询订阅外链状态
        querySubscribInfo: function () {
            window.locals.get('Elink_info', 'shareid', 'share_uk', 'uk', function (elinkInfo, shareid, shareUk, uk) {
                var isElink = elinkInfo.isElink === 1;
                // 企业外链&&主态外链不展示
                if (shareUk === uk || isElink) {
                    return;
                }
                pri.conf.shortUrlData = '[{\"uk\":' + shareUk + ',' + '\"share_id\":' + shareid + '}]';
                $.ajax({
                    type: 'post',
                    url: pri.api.querySubscribApi,
                    data: {
                        list: pri.conf.shortUrlData
                    },
                    dataType: 'json',
                    timeout: 100000,
                    success: function (res) {
                        if (res && res.errno === 0) {
                            try {
                                if (res.data.list
                                    && res.data.list.length
                                    && res.data.list[0].status === 0
                                ) {
                                    pri.util.changeSubscribeBtn(
                                        '.subscribe-btn',
                                        '<em class="icon noicon pdr3px noicon-yidingyue" title="已订阅"></em>已订阅',
                                        true,
                                        {
                                            background: 'transparent',
                                            border: '1px solid #C3EAFF',
                                            color: '#06A7FF'
                                        }
                                    );
                                    context.log.send({
                                        type: 'subscribed_display',
                                        value: '已订阅按钮展现'
                                    });
                                } else {
                                    pri.util.changeSubscribeBtn(
                                        '.subscribe-btn',
                                        '<em class="icon noicon pdr3px noicon-dingyue" title="订阅链接"></em>订阅链接',
                                        false,
                                        {
                                            background: '#06A7FF',
                                            color: '#FFFFFF'
                                        }
                                    );
                                    context.log.send({
                                        type: 'subscribe_display',
                                        value: '订阅按钮展现'
                                    });
                                }
                            } catch (error) {
                                console.log(error);
                            }
                        }
                        $('.subscribe-btn').show();
                        pri.util.handleSubscribeClick();
                        pri.util.subscribeTipsShow();
                    }
                });
            });
        },
        // 订阅
        addSubscribe: function () {
            context.log.send({
                type: 'subscribe_clk',
                value: '订阅按钮点击'
            });
            var tip = context.ui.tip({
                mode: 'loading',
                msg: '订阅中...'
            });
            $.ajax({
                type: 'post',
                url: pri.api.addSubscribeApi,
                data: {
                    list: pri.conf.shortUrlData
                },
                dataType: 'json',
                timeout: 100000,
                success: function (res) {
                    if (res && res.errno === 0
                        && res.data && res.data.length
                        && res.data[0].result === 0
                    ) {
                        pri.util.changeSubscribeBtn(
                            '.subscribe-btn',
                            '<em class="icon noicon pdr3px noicon-yidingyue" title="已订阅"></em>已订阅',
                            true,
                            {
                                background: 'transparent',
                                border: '1px solid #C3EAFF',
                                color: '#06A7FF'
                            }
                        );
                        tip.hide();
                        pri.util.initSuccessDialog();
                        dialog.show();
                        context.log.send({
                            type: 'subscribed_display',
                            value: '已订阅按钮展现'
                        });
                        context.log.send({
                            type: 'tc_succeed_display',
                            value: '订阅成功弹窗展现'
                        });
                    } else if (res && res.errno === -6) {
                        tip.hide();
                        pri.util.toLogin();
                    } else {
                        context.ui.tip({
                            mode: 'caution',
                            msg: '订阅失败，请稍后再试',
                            sticky: false
                        });
                    }
                },
                error: function () {
                    context.ui.tip({
                        mode: 'caution',
                        msg: '订阅失败，请稍后再试',
                        sticky: false
                    });
                }
            });
        },
        // 取消订阅
        cancelSubscribe: function () {
            context.ui.tip({
                mode: 'loading',
                msg: '取消订阅中...'
            });
            $.ajax({
                type: 'post',
                url: pri.api.cancelSubscribeApi,
                data: {
                    list: pri.conf.shortUrlData
                },
                dataType: 'json',
                timeout: 100000,
                success: function (res) {
                    if (res && res.errno === 0
                        && res.data && res.data.length
                        && res.data[0].result === 0
                    ) {
                        pri.util.changeSubscribeBtn(
                            '.subscribe-btn',
                            '<em class="icon noicon pdr3px noicon-dingyue" title="订阅链接"></em>订阅链接',
                            false,
                            {
                                background: '#06A7FF',
                                color: '#FFFFFF'
                            }
                        );
                        context.ui.tip({
                            mode: 'success',
                            msg: '取消订阅成功',
                            sticky: false
                        });
                        context.log.send({
                            type: 'subscribe_display',
                            value: '订阅按钮展现'
                        });
                    } else {
                        context.ui.tip({
                            mode: 'caution',
                            msg: '取消订阅失败，请稍后再试',
                            sticky: false
                        });
                    }
                },
                error: function () {
                    context.ui.tip({
                        mode: 'caution',
                        msg: '取消订阅失败，请稍后再试',
                        sticky: false
                    });
                }
            });
        },
        handleSubscribeClick: function () {
            $('.subscribe-btn').click(function () {
                locals.get('loginstate', function (isLogin) {
                    if (isLogin === 0) {
                        pri.util.toLogin();
                        return;
                    }
                    if (pri.conf.hasSubscribed) {
                        pri.util.initCancelDialog();
                        dialog.show();
                        context.log.send({
                            type: 'subscribed_clk',
                            value: '已订阅按钮点击'
                        });
                        context.log.send({
                            type: 'tc_cancel_display',
                            value: '取消订阅弹窗展现'
                        });
                    } else {
                        pri.util.addSubscribe();
                    }
                });
            });
        },
        toLogin: function () {
            window.yunHeader.login.util.loginNew();
        },
        changeSubscribeBtn: function (dom, text, hasSubscribed, cssMap) {
            // bca-disable-line
            $(dom).html(text);
            // $(dom).css(cssMap);
            pri.conf.hasSubscribed = hasSubscribed;
        },
        // 订阅成功弹窗
        initSuccessDialog: function () {
            var config = {
                title: '订阅成功',
                className: 'success-subscribe',
                body: '<div class="success-content">'
                    + '链接更新内容时，您将收到实时通知，可在网盘app「共享-订阅的分享」查看管理链接</div>',
                draggable: false,
                width: '512px',
                position: {
                    xy: 'center'
                },
                buttons: [
                    {
                        name: 'confirm',
                        title: '我知道了',
                        type: 'big',
                        color: 'blue',
                        position: 'center',
                        padding: [50, 50],
                        click: function () {
                            dialog.hide();
                            context.log.send({
                                type: 'tc_succeed_clk',
                                value: '订阅成功弹窗点击'
                            });
                        }
                    }
                ]
            };
            dialog = context.ui.window(config);
        },
        // 取消订阅弹窗
        initCancelDialog: function () {
            var config = {
                title: '取消订阅',
                className: 'cancel-subscribe',
                body: '<div class="cancel-content">'
                    + '不再订阅此分享后，将不再收到更新内容时的实时通知</div>',
                draggable: false,
                width: '480px',
                position: {
                    xy: 'center'
                },
                buttons: [
                    {
                        name: 'confirm',
                        title: '继续订阅',
                        type: 'big',
                        color: 'blue',
                        position: 'center',
                        padding: [50, 50],
                        click: function () {
                            dialog.hide();
                            context.log.send({
                                type: 'tc_cancel_2_clk',
                                value: '取消订阅弹窗继续订阅点击'
                            });
                        }
                    },
                    {
                        name: 'cancel',
                        title: '不再订阅',
                        type: 'big',
                        position: 'center',
                        padding: [50, 50],
                        click: function () {
                            dialog.hide();
                            pri.util.cancelSubscribe();
                            context.log.send({
                                type: 'tc_cancel_1_clk',
                                value: '取消订阅弹窗不再订阅点击'
                            });
                        }
                    }
                ]
            };
            dialog = context.ui.window(config);
        },
        // 订阅引导
        subscribeTipsShow: function () {
            var hasShowSubTips = localStorage.getItem('has_showsubtips') || false;
            if (hasShowSubTips || pri.conf.hasSubscribed) {
                return;
            }
            $('.subscribe-tips').show();
            setTimeout(function () {
                localStorage.setItem('has_showsubtips', true);
                $('.subscribe-tips').hide();
            }, 5000);
        }
    },
    init: function (tplType, isThirdLink) {
        var key = pri.util.getSekey();
        if (key) {
            var keyParam = '&is_from_web=true&sekey=' + key;
            pri.api.querySubscribApi += keyParam;
            pri.api.addSubscribeApi += keyParam;
            pri.api.cancelSubscribeApi += keyParam;
        }
        // 获取是否自动订阅外链小流量
        pri.util.getAutoSubStatus();
        // 获取外链订阅状态
        pri.util.querySubscribInfo();
        // 处理订阅按钮位置
        setTimeout(function () {
            var right = $('.x-button-box').width() + 2;
            if (window.SHAREPAGETYPE === 'single_file_page') {
                if (tplType === 'new') {
                    $('.subscribe-btn',).css({
                        right: right + 'px',
                        bottom: '40px'
                    });
                } else {
                    $('.subscribe-btn',).css({
                        right: right + 'px'
                    });
                }
                $('.subscribe-tips',).css({
                    right: (right - 156) + 'px',
                    bottom: '0'
                });
            } else {
                $('.subscribe-tips',).css({
                    right: (right - 156) + 'px',
                    bottom: '-9px'
                });
                if (isThirdLink) {
                    $('.subscribe-btn',).css({
                        right: '179px'
                    });
                    var downloadBtn = $('.slide-show-right .g-button.tools-share-V20-btn[title="下载"]');
                    downloadBtn.addClass('last_btn');
                }
            }
             // 处理按钮样式
            if (window.locals.get('self')) {
                $('.tools-share-V20-btn[node-type="unLinkShare"]').addClass('first_btn');
            }
        }, 500);
    }
};

module.exports = pri;
 
});
;define('disk-share:widget/pageModule/share-header/btns.js', function(require, exports, module){ /**
 * @file 处理点赞、评论、分享等
 * @author: yuanchengyong@baidu.com
 * @date: 16/3/16
 */

var $ = require('base:widget/libs/jquerypacket.js');
var context = require('system-core:context/context.js').instanceForSystem;
var fileList = window.locals.get('file_list') || [];
var fileMeta = fileList[0] || {};

var pri = {
    obj: {
        isAlreadyGetLike: false,
        shareFileName: ''

    },
    mod: {
        like: 'a.funcs-tui',
        share: 'div.funcs-share',
        panel: '#bdshare_panel',
        shareArea: 'span.funcs-share-area'
    },
    api: {
        getLikes: '/pcloud/like/data',
        shareList: '/share/list'
    },
    util: {
        // 获取文件名称
        getFileName: function () {
            pri.obj.shareFileName = fileMeta.server_filename;
            if (window.SHAREPAGETYPE === 'multi_file') {
                pri.obj.shareFileName += '等';
            }
        },
        // 获取评论等数据
        getLikes: function () {
            if (pri.obj.isAlreadyGetLike) {
                return;
            }
            $.ajax({
                type: 'post',
                url: pri.api.getLikes,
                data: {
                    type: 1,
                    query_uk: window.locals.get('share_uk'),
                    source_id: window.locals.get('shareid')
                },
                dataType: 'json',
                timeout: 100000,
                success: function (data) {
                    if (pri.obj.isAlreadyGetLike) {
                        return;
                    }
                    if (data && data.errno === 0) {
                        pri.obj.isAlreadyGetLike = true;
                        pri.util.upDateLike(data);
                    }
                }
            });
        },
        // 更新按钮
        upDateLike: function (data) {
            var likeText = '';
            // var commentText = '';
            var likeCount = data.like_count > 999 ? '999+' : data.like_count;
            // var commentCount = data.comment_count > 999 ? '999+' : data.comment_count;
            // 自己赞过
            if (data && data.like_status === 1) {
                likeText = '已赞(' + likeCount + ')';
                $(pri.mod.like).children('em').removeClass('tui_icon');
            }
            // 自己未赞过
            else if (data && data.like_status === 0) {
                likeText = '赞(' + likeCount + ')';
                $(pri.mod.like).children('em').addClass('tui_icon');
            }

            $(pri.mod.like).data({
                count: data.like_count,
                status: data.like_status
            });
            $(pri.mod.like).children('b').text(likeText);
        },
        /**
         * 获取外链包中文件列表
         * @returns {Promise} 返回请求Promise
         */
        getShareList: function () {
            var _surl = window.location.pathname.split('/s/')[1] || '';
            var url = pri.api.shareList;
            var newSurl = window.location.pathname;
            var linkSource = '';

            if (/\/link\//.test(newSurl)) {
                // 三方外链
                var urlParts = newSurl.split('/');
                newSurl = urlParts[3];
                linkSource = urlParts[2];
            } else {
                // 个人外链 - 去掉字符串开头的1
                newSurl = _surl.split('').slice(1).join('');
            }

            url += '?web=5&app_id=250528&desc=1&showempty=0&page=1&num=20&order=time&shorturl=' + newSurl + '&root=1&view_mode=1';

            return new Promise((resolve, reject) => {
                $.ajax({
                    url,
                    type: 'GET',
                    context: this, // 确保回调函数中的this指向FileTreeDialog实例
                    error: (err) => {
                        console.error('share/list error:', err);
                        reject(err);
                    },
                    success: function(res) {
                        if (res.errno === 0 && res.list) {
                            var fileData = res.list || [];
                            var allShareFileFsid = fileData.map(item =>
                                item.fs_id || item.fsid || ''
                            );
                            sessionStorage.setItem('share_files_fsids', JSON.stringify(allShareFileFsid));
                            resolve(res.list);
                        } else {
                            console.warn('share/list response:', res);
                            reject(new Error('Invalid response'));
                        }
                    }
                });
            });
        },
    },
    bindEvent: function () {
        // 赞按钮事件
        $(pri.mod.like).on('click', function () {
            context.log.send({
                name: 'web_share_click_like',
                value: '外链页点击赞'
            });
            var btnDOM = $(this);
            context.message.callPlugin('网盘链接管理-点赞@com.baidu.pan.share', {
                state: +btnDOM.data('status'),
                sourceUk: window.locals.get('share_uk'),
                type: 0,
                sourceId: window.locals.get('shareid'),
                ele: $('#albumTui'),
                btnDom: btnDOM
            });
        });
    },
    init: function () {
        pri.util.getFileName();
        pri.bindEvent();
        pri.util.getLikes();
        pri.util.getShareList();
    }
};

pri.init();

 
});
;define("disk-share:widget/pageModule/share-header/reportBad.js",function(e,t,o){var i=e("base:widget/libs/jquerypacket.js"),r=e("system-core:context/context.js").instanceForSystem,n={obj:{reportDialog:null,reportOkDialog:null},mod:{reportInfoBox:"div.report-info-box",btnReport:"a[node-type=btn-report]",reportReason:"div[node-type=report-reason] input",reportReasonSpan:"div[node-type=report-reason] span"},tmpl:{reportTitle:'<ol><li>影视、音乐、软件、文学等版权类和其他侵权投诉<a target="_blank" href="http://copyright.baidu.com/index.php/index/complaint" >侵权投诉</a></li><li class="report-mt20">违法有害信息，请在下方选择原因提交举报。</li></ol>',reportContent:'<div class="report-reason" node-type="report-reason"><p class="report-reason-title">举报原因：</p><span><input type="radio" value="2" checked="checked"  name="reportReason" /><label>色情低俗</label></span><span><input type="radio" value="5"  name="reportReason" /><label>涉嫌违法犯罪</label></span><span><input type="radio" value="4"  name="reportReason" /><label>时政信息不实</label></span><span><input type="radio" value="3"  name="reportReason" /><label>血腥暴力</label></span></div>',reportOkContent:'<div class="report-ok-info"><div class="report-ok-left"></div><div class="report-ok-right"><p>举报成功,谢谢!</p><p>您的举报我们会尽快处理,感谢您对百度网盘的支持</p></div></div>'},api:{sumitReason:"/api/report/bad"},util:{getDialog:function(e,t){return n.obj[e]||(n.obj[e]=r.ui.window(t)),n.obj[e]},newReportDialog:function(e){var t,o,i="",r="";r=e&&"sharelink"===e.feture||e&&"sharefile"===e.feture?n.tmpl.reportTitle+n.tmpl.reportContent:n.tmpl.reportContent,i=e&&"groupfile"===e.feture?"举报文件":"举报",o={title:i,body:'<div class="content"><div class="alert-dialog-msg">'+r+"</div></div>",draggable:!0,width:480,position:{xy:"center"},buttons:[{name:"confirm",title:"提交",type:"big",color:"blue",padding:["50px","50px"],position:"center",click:function(){n.util.reportBtnOk(e)}}]},t=n.util.getDialog("reportDialog",o),t.$dialog.addClass("report-info-box"),t.show(),n.util.bindEvent()},newReportOkDialog:function(){var e,t;e={title:"成功",body:'<div class="content"><div class="alert-dialog-msg">'+n.tmpl.reportOkContent+"</div></div>",draggable:!1,width:480,position:{xy:"center"},noHeader:!0},t=n.util.getDialog("reportOkDialog",e),t.$dialog.addClass("report-info-box"),t.show(),i("#"+t.dialogId).off().on("click",function(){t.hide()}),setTimeout(function(){t.hide()},3e3)},reportBtnOk:function(e){e.report_type=i(n.mod.reportReason+":checked").val(),n.util.reportSubmt(e)},reportSubmt:function(e){var t=r,o=e;return 1!==window.locals.get("loginstate")?(n.util.toLogin(),!1):(n.util.getDialog("reportDialog").hide(),void i.post(n.api.sumitReason,o,function(e){e&&0===e.errno?n.util.newReportOkDialog():e&&-6===e.errno?n.util.toLogin():t.ui.tip({mode:"caution",msg:t.errorMsg(e.errno,"请稍候重试!"),sticky:!1})}))},toLogin:function(){window.yunHeader.login.util.loginNew()},reportLogger:function(e){r.log.send({name:"shareReportBad",value:"外链页举报"+e})},getWidgets:function(t,o){e.async(t,function(){o.apply(this,arguments)},function(){r.ui.tip({mode:"caution",msg:"组件加载失败"})})},bindEvent:function(){i("body").on("click",n.mod.reportReasonSpan,function(){i(this).children("input").prop("checked",!0)})}}},a=function(){var e=[],t={},o=r,a=o.list.getSelected(),l=!1,p=!1;for(var s in a)e.push(a[s].fs_id),1===a[s].isdir&&(l=!0);return e.length>10&&(p=!0),l?(o.ui.tip({msg:"不能举报文件夹",mode:"caution"}),!1):p?(o.ui.tip({msg:"单次举报不能超过10个文件",mode:"caution"}),!1):void window.locals.get("share_uk","shareid",function(o,r){t=e&&e.length>0?{tpl:encodeURI("report"),feture:encodeURI("sharefile"),item_id:i.stringify(e),item_url:window.location.href,item_uk:o}:{tpl:"report",feture:"sharelink",item_id:i.stringify([r]),item_url:window.location.href,item_uk:o},n.util.newReportDialog(t),n.util.reportLogger(t.feture)})};i(".report-bad").click(function(){a()}),o.exports.init=a});
;define("disk-share:widget/pageModule/start/preFetchData.js",function(t,e,a){var n=t("base:widget/libs/jquerypacket.js"),o=t("disk-share:widget/system/util/util.js"),i={api:{getCompanyList:"/api/enterprise/organization/allorganizationinfo",showSyncSpace:"/act/api/conf?conf_key=working_space_is_show_share_save",tipsConfApi:"/act/api/conf?conf_key=working_space_share_save_tips",getWorkSpaceStatus:"/workspace/userquery",yunPrintSwitch:"/act/api/conf?conf_key=cloud_print_guide_web"},util:{mapList:function(t){var e=t.map(function(t){var e=t.orgInfo;return{ciduk:e.ciduk,name:e.name,desc:"空间容量"+o.toFriendlyFileSize(e.company_quota_used)+"/"+o.toFriendlyFileSize(e.company_quota),used:o.toFriendlyFileSize(e.company_quota_used),total:o.toFriendlyFileSize(e.company_quota),cid:e.cid,avator:o.getFirstWord(e.name),brief:e.brief,productType:e.product_type,role:e.role,total_user_num:e.total_user_num,avatorImg:e.logo,certStatus:e.cert_status,cancelCert:e.cancel_status}});return e},preFetchInit:function(){i.util.getCompanyListFn(),i.util.getIsShowSyncSpace(),i.util.getTipsConf(),i.util.queryWorkSpaceUseStatus(),i.util.getYunPrintSwitch()},getCompanyListFn:function(){n.ajax({url:i.api.getCompanyList,data:{},type:"get",dataType:"json",success:function(t){var e=t.data,a=[];a=e&&e.length>0?i.util.mapList(e):[],window.locals.set("preFetchCompanyList",a)},error:function(){window.locals.set("preFetchCompanyList",[])}})},getIsShowSyncSpace:function(){n.ajax({url:i.api.showSyncSpace,data:{},type:"get",dataType:"json",success:function(t){0===t.errno&&t.data&&t.data.length?window.locals.set("preFetchIsShowSyncSpace","true"===t.data[0].conf_value.isShow):window.locals.set("preFetchIsShowSyncSpace",!1)},error:function(){window.locals.set("preFetchIsShowSyncSpace",!1)}})},getTipsConf:function(){n.ajax({url:i.api.tipsConfApi,type:"get",dataType:"json",success:function(t){var e=t.data[0].conf_value||{};window.locals.set("preFetchTipsConf",e)},error:function(){window.locals.set("preFetchTipsConf",{})}})},getYunPrintSwitch:function(){n.ajax({url:i.api.yunPrintSwitch,type:"get",dataType:"json",success:function(t){var e=t.data[0]&&t.data[0].conf_value||{};window.locals.set("preFetchNewPrintSwitch",e)},error:function(){window.locals.set("preFetchNewPrintSwitch",{})}})},queryWorkSpaceUseStatus:function(){n.ajax({url:i.api.getWorkSpaceStatus,type:"get",dataType:"json",success:function(t){var e=t.data&&!!t.data.is_used;window.locals.set("preFetchIsWorkSpaceUser",e)},error:function(){window.locals.set("preFetchIsWorkSpaceUser",!1)}})}}};a.exports=function(){i.util.preFetchInit()}()});
;define("disk-share:widget/pageModule/share-file-main/share-single.js",function(e){e("system-core:context/context.js").instanceForSystem.message.trigger("share-person-info","show-intro"),e("disk-share:widget/system/util/adPlatform/adPlatform.js").getAdResoucre({list:[{id:"web-sharelinkpic",w:200,h:200},{id:"web-sharesinglebanner",w:710,h:90}]}),window.locals.get("public")&&e("disk-share:widget/system/singleFileComment/singleFileComment.js");var s=e("disk-share:widget/system/util/getCookies.js");window.currentSekey=s("BDCLND")});
;define("disk-share:widget/pageModule/sidebar-business-ad/sidebar-business-ad.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),s=e("system-core:context/context.js").instanceForSystem,a={mod:".module-sidebar-business-ad",content:".business-ad-content",mask:".business-ad-mask",maskImg:".business-ad-mask-img",maskVideo:".business-ad-mask-video",main:"body, #layoutApp",footerText:".module-share-footer *"},n=(t(a.mod),t(a.content)),o=t(a.mask),i=t(a.maskImg),d=t(a.maskVideo),r=700,m=1e3,l={getAd:function(){function e(e){var t=e.data;t&&t.type&&("ad"===t.type&&(console.log("[广告SDK]: 广告模式："+t.name),clearTimeout(o),("ad_conf_default"===t.name||"default"===t.name||t.notShowExternalAd&&"external"===t.adType||!t.data.theme)&&a(),i.className="business-ad-frame",t.data.dynamicColor&&l.setAdThemeColor(t.data.dynamicColor[0])),"dynamicColor"===t.type&&l.setAdThemeColor(t.data))}function a(){n.addClass("theme-default"),t(i).hide(),s.log.send({name:"web_share_list_business_ad_default",value:"列表页默认广告"})}window.addEventListener("message",e,!1);var o=setTimeout(function(){console.log("[广告SDK]: 加载异常, 兜底方案"),window.removeEventListener("message",e,!1),a()},3e3),i=document.createElement("iframe"),d=n[0],r=sessionStorage.getItem("B_AD_TYPE");i.src="/buy/ad/home?pathname=/share_weblist&from=weblist",r&&(i.src+="&businessAdType="+r),i.className="business-ad-frame-none",d.appendChild(i)},getAdRects:function(){return n[0].getBoundingClientRect()},closeMask:function(){var e=this;window.requestAnimationFrame(function(){var t=e.getAdRects();t&&(o.css({"will-change":"transform",transition:"all "+r+"ms",width:t.width||"272px",height:t.height||"588px",top:t.top+"px",left:t.left+"px",opacity:"0","border-radius":"24px"}),i.css({"will-change":"transform",transition:"all "+r+"ms","background-position":"-"+t.left+"px -"+t.top+"px"}),d.css({"will-change":"transform",transition:"all "+r+"ms","margin-left":"-"+t.left+"px","margin-top":"-"+t.top+"px"}))})},setAdThemeColor:function(e){if(e){var s=e.main,n=e.listFooterText;window.requestAnimationFrame(function(){t("head").append('<meta name="theme-color" content="'+t("body").css("background-color")+'"/>'),s&&t(a.main).css({"background-color":s,transition:"background-color 0.1s linear"}),n&&t(a.footerText).css({color:n,transition:"color 0.1s linear"})})}},init:function(){this.closeMask(),setTimeout(function(){l.getAd()},r),setTimeout(function(){o.hide()},m)}};l.init()});
;define("disk-share:widget/pageModule/share-person-info/share-person-info-new.js",function(e){var o=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/storage/storage.js"),t=e("system-core:context/context.js").instanceForSystem,i=e("disk-share:widget/system/util/certThemeRender.js"),s=e("disk-share:widget/system/util/enterpriseThemeRender.js"),a=e("disk-share:widget/system/util/getCookies.js");e("disk-share:widget/pageModule/share-person-info/service/adPanLog.js");var l={mod:".module-share-person-info",followBtn:'a[node-type~="share-follow-btn"]',followTxt:'span[node-type~="follow-txt"]',sharePersonInfoTmpl:'textarea[node-type~="tmpl-share-person-info"]',sharePersonNumbers:'ul[node-type="share-person-numbers"]',personIcon:".person-icon",addFriend:".verify-friend",sendMag:".verify-send",subBtn:'button[node-type="verb-button"]',iconLine:".share-person-data-top"},r="立即订阅",d="相互订阅",c="已订阅",u="follow",f="",p={captchatype:void 0,captchaidentity:void 0,normalize:function(e,o){if("string"!=typeof e||0===e.length)return e;if(null===o||"string"!=typeof o)return e;var n,t=-1!==e.indexOf("?"),i=e.substring(e.length-1),s="bdstoken="+o;return n="&"===i||"?"===i?e+s:t?e+"&"+s:e+"?"+s},api:{getInfo:"/subscribe/personalpage/userinfo",subApi:"/subscribe/personalpage/follow",addFollow:"/pcloud/friend/addfollow",removeFollow:"/pcloud/friend/removefollow",userReport:"/api/report/user",addFriend:"/mbox/relation/addfriend"}},w=o(l.mod),g={templatePromise:null,templateReady:!1,templateData:{intro:"",avatar_url:"",pubshare_count:0,album_count:0,follow_count:0,fans_count:0,query_uk:"",follow_class:"",fans_class:"",uname:"",follow_txt:r,btnClass:""},getShareUserIntro:function(){o.ajax({type:"post",url:p.api.getInfo,crossDomain:!0,xhrFields:{withCredentials:!0},contentType:"application/x-www-form-urlencoded",data:{uk:window.locals.get("share_uk")},success:function(e){if(e&&!e.errno){var n=e.user_info;if(n&&n.is_bussiness){var i=o(l.iconLine);o(l.addFriend).hide(),o(l.sendMag).hide(),i.append('<a href="'+n.shop_url+'" class="duxiaomai sicon"><em></em></a>')}if(!window.locals.get("self")){t.log.send({name:"sub_btn_display_count",value:"外链页【订阅】按钮出现的次数用户数"});var s="";n&&n.is_follow?(s="取消订阅",u="cancel",f="cancel"):s="订阅",w.append('<div node-type="verb-info" class="verb-info"><button node-type="verb-button" class="verb-button '+f+'">'+s+"</button></div>")}}}})},addFollow:function(e,n){o.ajax({url:p.normalize(p.api.addFollow,window.locals.get("bdstoken")),type:"post",data:{appid:e.appid||null,follow_uk:e.uk||null,follow_uname:e.uname||null,mark_name:e.mark_name||null,group_id:e.group_id||null},dataType:"json",success:function(e){n(e.errno)}}),this.reportLogger()},delFollow:function(e,n){o.ajax({url:p.normalize(p.api.removeFollow,window.locals.get("bdstoken")),type:"post",data:{follow_uk:e.uk},dataType:"json",success:function(e){n(e.errno)}}),this.reportLogger()},reportLogger:function(e){e=e?e:"web_friend_api",o.ajax({url:p.api.userReport,type:"POST",data:{timestamp:Math.round(new Date/1e3),action:e}})},addFriend:function(e,n){var i=window.locals.get("share_uk"),s=p.api.addFriend+"?uk="+i+"&type=normal&scene=0",a=t.ui.tip({mode:"loading",msg:"发送中..."});o.post(s,e,function(e){a.hide(),n(e)})},disposeAddFriend:function(n,i){var s=this;p.input&&o.extend(n,{input:p.input,vcode:p.vcode}),this.addFriend(n,function(a){if("string"==typeof a)try{a=JSON.parse(a)}catch(l){}if(a&&0===a.errno)return 2===a.status?(o(".verify-friend").css("opacity",.6).html("等待验证"),void i.hide()):(t.ui.tip({mode:"success",msg:"添加好友成功",sticky:!1}),i.hide(),void location.reload());if(a&&2165===a.errno)return void t.ui.tip({mode:"caution",msg:"对方拒绝任何人添加其为好友",sticky:!1});if(a&&2163===a.errno){var r=a.permission.type;if(o(".add-friend").attr("data-type",r),0===+r)i.show();else if(2===+r){var d=a.permission.question;o(".verify-hint").html("问题："+d+"?"),o(".verify-text").attr("maxlength",20),i.show()}}else if(a&&-19===a.errno)i.hide(),e("disk-share:widget/system/verifyCodeDialog/newVerify.js").show({onSubmitFunc:function(e,o){p.captchatype=o,p.captchaidentity=e,s.disposeAddFriend(n)}});else{var c=a.errno,u="";if(-6===c)return void window.yunHeader.login.util.loginNew();switch(c){case 2117:u="好友超出限制了";break;case 2118:u="已经是好友",location.reload();break;case 2115:u="不能添加自己为好友";break;case 2164:u="问题回答错误";break;default:u="加好友太频繁，请稍后再试"}t.ui.tip({mode:"caution",msg:u,sticky:!1})}})},_bindEvent:function(){var e,i=this,s={};this._bindLogEvent(),w.delegate(l.subBtn,"click",function(){t.log.send({name:"sub_btn_click_count",value:"外链页【订阅】按钮被点击的次数用户数"}),o.ajax({type:"post",url:p.api.subApi,crossDomain:!0,xhrFields:{withCredentials:!0},contentType:"application/x-www-form-urlencoded",data:{action:u,uk:window.locals.get("share_uk")},success:function(e){if(!e.errno){var n=o(l.subBtn);"订阅"===n.text()?(n.text("取消订阅"),u="cancel",n.addClass(f)):(n.text("订阅"),u="follow",n.removeClass(f))}}})}),w.delegate(l.followBtn,"click",function(a){var u,f,p=o(a.currentTarget),w=p.find(l.followTxt),g=p.data("followtype"),m={uk:window.locals.get("share_uk"),uname:window.locals.get("linkusername"),appid:123123};return 1!==window.locals.get("loginstate")?(window.yunHeader.login.util.loginNew(),window.yunHeader.on("loginSuccess",function(){n.setItem("followAction","1")}),!1):(p.hasClass("follow")?(m.follow_uname=i.templateData.uname,w.html("订阅中"),p.removeClass("follow").addClass("following"),i.addFollow(m,function(e){e?(w.html(r),p.removeClass("following").addClass("follow"),t.ui.tip(-6===e?{mode:"caution",msg:"订阅失败，用户未登录",sticky:!1}:{mode:"caution",msg:"订阅失败，请刷新后再试",sticky:!1})):1===g?(w.html(d),p.removeClass("following").addClass("mutualfollow").data("followtype",2)):(w.html(c),p.removeClass("following").addClass("followed").data("followtype",0))})):p.hasClass("followed")?(s={title:"取消订阅",className:"un-follow",body:'<div class="content">确定不再订阅“'+m.uname+"”了吗？</br>(取消订阅后你就不能看到TA的分享动态了哦。)</div>",draggable:!1,width:"480px",position:{xy:"center"},buttons:[{name:"confirm",title:"确定",type:"big",color:"blue",position:"center",padding:[50,50],click:function(){u()}},{name:"cancel",title:"取消",type:"big",position:"center",padding:[50,50],click:function(){f()}}]},w.html("取消中"),p.removeClass("followed").addClass("unfollowing"),"undefined"==typeof e&&(e=t.ui.window(s)),e.show(),u=function(){e.hide(),i.delFollow(m,function(e){e?(console.warn("del follow fail"),w.html(c),p.removeClass("unfollowing").addClass("followed")):(w.html(r),p.removeClass("unfollowing").addClass("follow").data("followtype",-1))})},f=function(){e.hide(),w.html(c),p.removeClass("unfollowing").addClass("followed")}):p.hasClass("mutualfollow")&&(s={title:"取消订阅",className:"un-follow",body:'<div class="content">确定不再订阅“'+m.uname+"”了吗？</br>(取消订阅后你就不能看到TA的分享动态了哦。)</div>",draggable:!1,width:"480px",position:{xy:"center"},buttons:[{name:"confirm",title:"确定",type:"big",color:"blue",position:"center",padding:[50,50],click:function(){u()}},{name:"cancel",title:"取消",type:"big",position:"center",padding:[50,50],click:function(){f()}}]},"undefined"==typeof e&&(e=t.ui.window(s)),w.html("取消中"),p.removeClass("mutualfollow").addClass("unfollowing"),e.show(),u=function(){e.hide(),i.delFollow(m,function(e){e?(console.warn("del follow fail"),w.html(d),p.removeClass("unfollowing").addClass("mutualfollow")):(w.html(r),p.removeClass("unfollowing").addClass("follow").data("followtype",1))})},f=function(){w.html(d),p.removeClass("unfollowing").addClass("mutualfollow")}),!1)}),w.delegate(l.addFriend,"click",function(){if(t.log.send({type:"web_share_person_click_add_friend",value:"外链页详情页点击加好友"}),1!==+window.locals.get("loginstate"))return void window.yunHeader.login.util.loginNew();var n="等待验证"===o(this).text();if(!n){var s={title:"添加好友",className:"add-friend",body:'<div class="verify-content"><div class="verify-hint">对方需要你填写验证信息:</div><div class="verify-text-wrap"><textarea class="verify-text" maxlength="40"></textarea></div></div>',draggable:!1,width:"480px",position:{xy:"center"},buttons:[{name:"confirm",title:"确定",type:"big",color:"blue",position:"center",padding:[50,50],click:function(){a()}},{name:"cancel",title:"取消",type:"big",position:"center",padding:[50,50],click:function(){l()}}]};"undefined"==typeof e&&(e=t.ui.window(s));var a=function(){var n=o(".add-friend").data("type"),s=o(".verify-text").val().trim(),a={};if(s.length<1)return void t.ui.tip({mode:"caution",msg:"请填写认证信息",sticky:!1});var l=40;return 0===+n&&(a.text=s),2===+n&&(l=20,a.answer=s),s.length>l?void t.ui.tip({mode:"caution",msg:"输入不能超过"+l+"个字符",sticky:!1}):void i.disposeAddFriend(a,e)},l=function(){e.hide()};i.disposeAddFriend({},e)}}),w.delegate(l.sendMag,"click",function(){t.log.send({type:"web_share_person_click_send_msg",value:"外链页详情页点击发送消息"});var e=window.host&&window.host.HOST_PAN||"pan.baidu.com";window.open("https://"+e+"/mbox/homepage#share/type=session&fromUk="+window.locals.get("share_uk"))})},_bindLogEvent:function(){w.delegate(".share-person-avatar a","click",function(){}),w.delegate(".share-person-username","click",function(){}),w.delegate(".sicon","click",function(){t.log.send({name:"dlink_personal_info_sicon",value:"外链页个人信息皇冠icon"})})},getIntro:function(){o.get("/pcloud/user/getinfo",{query_uk:window.locals.get("share_uk"),third:0},function(e){if(e&&!e.errno){var n="";e.user_info&&e.user_info.intro&&(n="暂无签名"===e.user_info.intro?"":e.user_info.intro),""!==n&&o(".author-desc .author-intro").text(n)}})},setVipIcon:function(){this.sendReportLoggerHandler("web_share_browse"),window.locals.get("owner_vip_type","owner_vip_level",function(n,i){if(2===n&&i){var s="vipicon-"+n+"-"+i;0===i&&(s+=" cover"),s+=" vipicon",o(".share-person-data .sicon").addClass(s)}2===n&&e("disk-share:widget/system/util/makeup.js")("sharelist",t)})},setCertIcon:function(){var e=this;i("sharelist",function(o){o.isCertUser&&o.useCertTheme?(e.sendReportLoggerHandler("web_enterprise_owner_share_browse"),o.isOwner||t.log.send({name:"understand_cert_share-person_display_count",value:"企业用户分享-外链-头像下-了解企业账号"}),e.setBannerHide()):e.setVipIcon()},function(){e.setVipIcon()})},sendReportLoggerHandler:function(e){1===+window.locals.get("loginstate")&&this.reportLogger(e)},setEnterpriseInfo:function(){var e=this;s("sharelist",function(o){o.isEnterpriseLink?(e.sendReportLoggerHandler("web_enterprise_share_browse"),t.log.send({type:"web_share_list_page_enterprise_display",value:"web-企业空间-文件列表页-展示"}),e.setBannerHide()):e.setCertIcon()},function(){e.setCertIcon()})},setBannerHide:function(){o("#web-right-view").hide(),o("#web-single-bottom").hide(),o("#web-multi-bottom").hide()},init:function(){this.getIntro(),this._bindEvent(),this.setEnterpriseInfo(),this.setBannerHide(),window.currentSekey=a("BDCLND")}};t.message.listen("share-person-info",function(e){"show-intro"===e&&g.getShareUserIntro()}),g.init()});
;define("disk-share:widget/pageModule/share-header/share-top-bar/share-top-bar.js",function(e){var r=e("base:widget/libs/jquerypacket.js"),t=e("system-core:context/context.js").instanceForSystem,a=r(".module-share-top-bar");t.Broker.initButtonBroker({name:"shareTools",config:{container:a.find(".bar"),limit:5}})});
;define('disk-share:widget/pageModule/share-header/share-header-new.js', function(require, exports, module){ /* jslint browser: true, vars: true, nomen: true, indent: 4, maxlen: 110, plusplus: true, sloppy: true */
/* global mdev: true, console: true, require: true, yunData: true */

/**
 * @version [v1.0] 2014-07-07
 * @description share-person-info.js
 */


var $ = require('base:widget/libs/jquerypacket.js');
var tools = require('base:widget/tools/tools.js');
var storage = require('base:widget/storage/storage.js');
var context = require('system-core:context/context.js').instanceForSystem;
var util = require('disk-share:widget/system/util/util.js');
var agentUbcLog = require('disk-share:widget/system/util/logs/agentLog.js');
require('disk-share:widget/pageModule/share-header/reportBad.js');
require('disk-share:widget/pageModule/share-header/btns.js');
var subscribeLink = require('disk-share:widget/pageModule/share-header/subscribe-outside-link.js');
var isThirdLink = location.pathname.indexOf('/link/') > -1 || /(\?|&)linksource=/.test(location.search);
subscribeLink.init('new', isThirdLink);
var fileList = window.locals.get('file_list') || [];
var fileMeta = fileList[0] || {};
var fileName = tools.toEntity(fileMeta.server_filename);
var fileExtension = '';
var fileNameDom = $('.module-share-header .file-name');
var fileIconV20 = $('.module-share-header .files-icon-v20');
var isAutoExtractPwd = util.getSearch('pwd') || '';
var isWp = +fileMeta.wpfile === 1;
if (isWp) {
    fileName = fileName.replace(/\.(\w*?)$/, '');
    $('title').text(fileName + '_免费高速下载|百度网盘-分享无限制');
}
var staticPath = 'https://staticwx.cdn.bcebos.com/mini-program/images/';
var fileIconImg = '';
var icon = '';
switch (window.SHAREPAGETYPE) {
    case 'single_file_page':
        fileExtension = fileName.substring(fileName.lastIndexOf('.') + 1).toLowerCase();
        fileIconImg = staticPath + 'ic_other_v2.png';
        try {
            icon = util.getIconByExt(fileName);
            fileIconImg = staticPath + 'ic_' + icon +  '_v2.png';
        } catch (e) {}
        break;
    case 'multi_file':
        if (fileList.length === 1 && fileMeta.isdir) {
            fileExtension = 'dir';
            icon = 'dir';
        } else {
            fileExtension = 'multi';
            fileName += '等';
        }
        break;
}

window.locals.get('cfrom_id', 'owner_vip_type', 'sharetype', 'title_img', function (id, vipType, sharetype, titleImg) {
    context.log.send({
        name: 'web_third_link_page_show',
        value: {
            value: '外链页展示',
            from: Number(id),
            from0: vipType,
            refer: document.referrer
        }
    });
    // 串联agent数据,增加ubc打点
    try {
        var agentInfo = localStorage.getItem('BD_PAN_AGENT_INFO') || '';
        var [t, agentid, agentchannel] = agentInfo.split("_");
        var isSffective = t && new Date().getTime() - t < 86400000 ? true : false;

        if (isSffective) {
            agentUbcLog.sendlog("codeSuccessPageShow", {
                agentid,
                agentchannel
            });
        }
    } catch(err) {
        console.log('agent数据串联error', err);
    }


    if (isAutoExtractPwd) {
        context.log.send({
            type: 'web_auto_extract_shareLink_display',
            value: '自动填充提取码-外链页展示'
        });
    } else {
        context.log.send({
            type: 'web_need_extract_shareLink_display',
            value: '非自动填充提取码-外链页展示'
        });
    }

    if (String(sharetype) === '4') {
        $('.verify-user-protect-share-list').show();
    }

    fileIconV20.addClass(icon || 'other');
    // 外链单文件标题防止抓取，server 以base64形式下发图片，取title_img数组第一个值
    if (fileList.length === 1 && titleImg && !isThirdLink) {
        var imgDom = titleImg ? '<img style="vertical-align: top;" src=data:image/png;base64,' + titleImg[0]
            + '>' : '<img alt="' + fileName + '" >';
        /* bca-disable */
        fileNameDom.attr('title', '').html(imgDom);
        if (fileExtension === 'dir' || fileExtension === 'multi') {
            var src = 'https://staticsns.cdn.bcebos.com/amis/2024-8/1722592402960/%E6%96%87%E4%BB%B6%E5%A4%B9%20(2).png';
            if (fileExtension === 'multi') {
                src = 'https://staticsns.cdn.bcebos.com/amis/2024-8/1722592345759/%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6.png';
            }
            fileIconV20.html('<img src="'
            + src + '">');
        } else {
            /* bca-disable */
            fileIconV20.html('<img src="'
            + fileIconImg + '">');
        }
    } else {
        fileNameDom.attr('title', fileName)
            .html(fileName);
        if (fileExtension === 'dir' || fileExtension === 'multi') {
            var src = 'https://staticsns.cdn.bcebos.com/amis/2024-8/1722592402960/%E6%96%87%E4%BB%B6%E5%A4%B9%20(2).png';
            if (fileExtension === 'multi') {
                src = 'https://staticsns.cdn.bcebos.com/amis/2024-8/1722592345759/%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6.png';
            }
            fileIconV20.html('<img src="'
            + src + '">');
        } else {
            /* bca-disable */
            fileIconV20.html('<em class="global-icon-16 global-icon-16-'
            + fileExtension + '"></em> ');
        }
    }
});

// 网盘下载助手统计+临时屏蔽功能
setTimeout(function () {
    var helperSign = [
        '.panHelperBtn',
        '[data-key=downloadhelper]',
        '[node-type=btn-helper]'
    ];
    var $helperBtn = $(helperSign.join(','));
    if ($helperBtn.length) {
        try {
            context.log.send({
                name: 'sharePage_plugin_downloadhelper'
            });

            $.each($helperBtn, function (i, $item) {
                $item.remove();
            });
        } catch (e) {

        }
    }

}, 1000);

// 非登录态点击"保存到网盘"，强制登录，且登录成功后的回调
function checkLoginCallTransfer() {
    if (storage.getItem('transferFiles') === '1') {
        if (!window.locals.get('self')) {
            try {
                storageFiles = storage.getItem('transferFilesContent');
                storageFiles = JSON.parse(storageFiles);
            } catch (error) {
                console.log(error);
            }
            context.message.callPlugin('保存到网盘@com.baidu.pan.share', {
                filesList: storageFiles
            });
        }
        storage.removeItem('transferFiles');
        storage.removeItem('transferFilesContent');
    }
}

// 检测是否是登录回调函数
function checkLoginCallDownload() {
    if (storage.getItem('shareAutoDownload') === '1') {
        context.message.callPlugin('网盘下载@com.baidu.pan');
        storage.removeItem('shareAutoDownload');
    }
}

checkLoginCallTransfer();
checkLoginCallDownload();
 
});
;define("disk-share:widget/pageModule/share-person-info/share-person-info.js",function(e){var o=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/storage/storage.js"),t=e("system-core:context/context.js").instanceForSystem,i=e("disk-share:widget/system/util/certThemeRender.js"),s=e("disk-share:widget/system/util/enterpriseThemeRender.js"),a=e("disk-share:widget/system/util/getCookies.js");e("disk-share:widget/pageModule/share-person-info/service/adPanLog.js");var l={mod:".module-share-person-info",followBtn:'a[node-type~="share-follow-btn"]',followTxt:'span[node-type~="follow-txt"]',sharePersonInfoTmpl:'textarea[node-type~="tmpl-share-person-info"]',sharePersonNumbers:'ul[node-type="share-person-numbers"]',personIcon:".person-icon",addFriend:".verify-friend",sendMag:".verify-send",subBtn:'button[node-type="verb-button"]',iconLine:".share-person-data-top"},r="立即订阅",d="相互订阅",c="已订阅",u="follow",f="",p={captchatype:void 0,captchaidentity:void 0,normalize:function(e,o){if("string"!=typeof e||0===e.length)return e;if(null===o||"string"!=typeof o)return e;var n,t=-1!==e.indexOf("?"),i=e.substring(e.length-1),s="bdstoken="+o;return n="&"===i||"?"===i?e+s:t?e+"&"+s:e+"?"+s},api:{getInfo:"/subscribe/personalpage/userinfo",subApi:"/subscribe/personalpage/follow",addFollow:"/pcloud/friend/addfollow",removeFollow:"/pcloud/friend/removefollow",userReport:"/api/report/user",addFriend:"/mbox/relation/addfriend"}},w=o(l.mod),g={templatePromise:null,templateReady:!1,templateData:{intro:"",avatar_url:"",pubshare_count:0,album_count:0,follow_count:0,fans_count:0,query_uk:"",follow_class:"",fans_class:"",uname:"",follow_txt:r,btnClass:""},getShareUserIntro:function(){o.ajax({type:"post",url:p.api.getInfo,crossDomain:!0,xhrFields:{withCredentials:!0},contentType:"application/x-www-form-urlencoded",data:{uk:window.locals.get("share_uk")},success:function(e){if(e&&!e.errno){var n=e.user_info;if(n&&n.is_bussiness){var i=o(l.iconLine);o(l.addFriend).hide(),o(l.sendMag).hide(),i.append('<a href="'+n.shop_url+'" class="duxiaomai sicon"><em></em></a>')}if(!window.locals.get("self")){t.log.send({name:"sub_btn_display_count",value:"外链页【订阅】按钮出现的次数用户数"});var s="";n&&n.is_follow?(s="取消订阅",u="cancel",f="cancel"):s="订阅",w.append('<div node-type="verb-info" class="verb-info"><button node-type="verb-button" class="verb-button '+f+'">'+s+"</button></div>")}}}})},addFollow:function(e,n){o.ajax({url:p.normalize(p.api.addFollow,window.locals.get("bdstoken")),type:"post",data:{appid:e.appid||null,follow_uk:e.uk||null,follow_uname:e.uname||null,mark_name:e.mark_name||null,group_id:e.group_id||null},dataType:"json",success:function(e){n(e.errno)}}),this.reportLogger()},delFollow:function(e,n){o.ajax({url:p.normalize(p.api.removeFollow,window.locals.get("bdstoken")),type:"post",data:{follow_uk:e.uk},dataType:"json",success:function(e){n(e.errno)}}),this.reportLogger()},reportLogger:function(e){e=e?e:"web_friend_api",o.ajax({url:p.api.userReport,type:"POST",data:{timestamp:Math.round(new Date/1e3),action:e}})},addFriend:function(e,n){var i=window.locals.get("share_uk"),s=p.api.addFriend+"?uk="+i+"&type=normal&scene=0",a=t.ui.tip({mode:"loading",msg:"发送中..."});o.post(s,e,function(e){a.hide(),n(e)})},disposeAddFriend:function(n,i){var s=this;p.input&&o.extend(n,{input:p.input,vcode:p.vcode}),this.addFriend(n,function(a){if("string"==typeof a)try{a=JSON.parse(a)}catch(l){}if(a&&0===a.errno)return 2===a.status?(o(".verify-friend").css("opacity",.6).html("等待验证"),void i.hide()):(t.ui.tip({mode:"success",msg:"添加好友成功",sticky:!1}),i.hide(),void location.reload());if(a&&2165===a.errno)return void t.ui.tip({mode:"caution",msg:"对方拒绝任何人添加其为好友",sticky:!1});if(a&&2163===a.errno){var r=a.permission.type;if(o(".add-friend").attr("data-type",r),0===+r)i.show();else if(2===+r){var d=a.permission.question;o(".verify-hint").html("问题："+d+"?"),o(".verify-text").attr("maxlength",20),i.show()}}else if(a&&-19===a.errno)i.hide(),e("disk-share:widget/system/verifyCodeDialog/newVerify.js").show({onSubmitFunc:function(e,o){p.captchatype=o,p.captchaidentity=e,s.disposeAddFriend(n)}});else{var c=a.errno,u="";if(-6===c)return void window.yunHeader.login.util.loginNew();switch(c){case 2117:u="好友超出限制了";break;case 2118:u="已经是好友",location.reload();break;case 2115:u="不能添加自己为好友";break;case 2164:u="问题回答错误";break;default:u="加好友太频繁，请稍后再试"}t.ui.tip({mode:"caution",msg:u,sticky:!1})}})},_bindEvent:function(){var e,i=this,s={};this._bindLogEvent(),w.delegate(l.subBtn,"click",function(){t.log.send({name:"sub_btn_click_count",value:"外链页【订阅】按钮被点击的次数用户数"}),o.ajax({type:"post",url:p.api.subApi,crossDomain:!0,xhrFields:{withCredentials:!0},contentType:"application/x-www-form-urlencoded",data:{action:u,uk:window.locals.get("share_uk")},success:function(e){if(!e.errno){var n=o(l.subBtn);"订阅"===n.text()?(n.text("取消订阅"),u="cancel",n.addClass(f)):(n.text("订阅"),u="follow",n.removeClass(f))}}})}),w.delegate(l.followBtn,"click",function(a){var u,f,p=o(a.currentTarget),w=p.find(l.followTxt),g=p.data("followtype"),m={uk:window.locals.get("share_uk"),uname:window.locals.get("linkusername"),appid:123123};return 1!==window.locals.get("loginstate")?(window.yunHeader.login.util.loginNew(),window.yunHeader.on("loginSuccess",function(){n.setItem("followAction","1")}),!1):(p.hasClass("follow")?(m.follow_uname=i.templateData.uname,w.html("订阅中"),p.removeClass("follow").addClass("following"),i.addFollow(m,function(e){e?(w.html(r),p.removeClass("following").addClass("follow"),t.ui.tip(-6===e?{mode:"caution",msg:"订阅失败，用户未登录",sticky:!1}:{mode:"caution",msg:"订阅失败，请刷新后再试",sticky:!1})):1===g?(w.html(d),p.removeClass("following").addClass("mutualfollow").data("followtype",2)):(w.html(c),p.removeClass("following").addClass("followed").data("followtype",0))})):p.hasClass("followed")?(s={title:"取消订阅",className:"un-follow",body:'<div class="content">确定不再订阅“'+m.uname+"”了吗？</br>(取消订阅后你就不能看到TA的分享动态了哦。)</div>",draggable:!1,width:"480px",position:{xy:"center"},buttons:[{name:"confirm",title:"确定",type:"big",color:"blue",position:"center",padding:[50,50],click:function(){u()}},{name:"cancel",title:"取消",type:"big",position:"center",padding:[50,50],click:function(){f()}}]},w.html("取消中"),p.removeClass("followed").addClass("unfollowing"),"undefined"==typeof e&&(e=t.ui.window(s)),e.show(),u=function(){e.hide(),i.delFollow(m,function(e){e?(console.warn("del follow fail"),w.html(c),p.removeClass("unfollowing").addClass("followed")):(w.html(r),p.removeClass("unfollowing").addClass("follow").data("followtype",-1))})},f=function(){e.hide(),w.html(c),p.removeClass("unfollowing").addClass("followed")}):p.hasClass("mutualfollow")&&(s={title:"取消订阅",className:"un-follow",body:'<div class="content">确定不再订阅“'+m.uname+"”了吗？</br>(取消订阅后你就不能看到TA的分享动态了哦。)</div>",draggable:!1,width:"480px",position:{xy:"center"},buttons:[{name:"confirm",title:"确定",type:"big",color:"blue",position:"center",padding:[50,50],click:function(){u()}},{name:"cancel",title:"取消",type:"big",position:"center",padding:[50,50],click:function(){f()}}]},"undefined"==typeof e&&(e=t.ui.window(s)),w.html("取消中"),p.removeClass("mutualfollow").addClass("unfollowing"),e.show(),u=function(){e.hide(),i.delFollow(m,function(e){e?(console.warn("del follow fail"),w.html(d),p.removeClass("unfollowing").addClass("mutualfollow")):(w.html(r),p.removeClass("unfollowing").addClass("follow").data("followtype",1))})},f=function(){w.html(d),p.removeClass("unfollowing").addClass("mutualfollow")}),!1)}),w.delegate(l.addFriend,"click",function(){if(t.log.send({type:"web_share_person_click_add_friend",value:"外链页详情页点击加好友"}),1!==+window.locals.get("loginstate"))return void window.yunHeader.login.util.loginNew();var n="等待验证"===o(this).text();if(!n){var s={title:"添加好友",className:"add-friend",body:'<div class="verify-content"><div class="verify-hint">对方需要你填写验证信息:</div><div class="verify-text-wrap"><textarea class="verify-text" maxlength="40"></textarea></div></div>',draggable:!1,width:"480px",position:{xy:"center"},buttons:[{name:"confirm",title:"确定",type:"big",color:"blue",position:"center",padding:[50,50],click:function(){a()}},{name:"cancel",title:"取消",type:"big",position:"center",padding:[50,50],click:function(){l()}}]};"undefined"==typeof e&&(e=t.ui.window(s));var a=function(){var n=o(".add-friend").data("type"),s=o(".verify-text").val().trim(),a={};if(s.length<1)return void t.ui.tip({mode:"caution",msg:"请填写认证信息",sticky:!1});var l=40;return 0===+n&&(a.text=s),2===+n&&(l=20,a.answer=s),s.length>l?void t.ui.tip({mode:"caution",msg:"输入不能超过"+l+"个字符",sticky:!1}):void i.disposeAddFriend(a,e)},l=function(){e.hide()};i.disposeAddFriend({},e)}}),w.delegate(l.sendMag,"click",function(){t.log.send({type:"web_share_person_click_send_msg",value:"外链页详情页点击发送消息"});var e=window.host&&window.host.HOST_PAN||"pan.baidu.com";window.open("https://"+e+"/mbox/homepage#share/type=session&fromUk="+window.locals.get("share_uk"))})},_bindLogEvent:function(){w.delegate(".share-person-avatar a","click",function(){}),w.delegate(".share-person-username","click",function(){}),w.delegate(".sicon","click",function(){t.log.send({name:"dlink_personal_info_sicon",value:"外链页个人信息皇冠icon"})})},getIntro:function(){o.get("/pcloud/user/getinfo",{query_uk:window.locals.get("share_uk"),third:0},function(e){if(e&&!e.errno){var n="";e.user_info&&e.user_info.intro&&(n="暂无签名"===e.user_info.intro?"":e.user_info.intro),""!==n&&o(".author-desc .author-intro").text(n)}})},setVipIcon:function(){this.sendReportLoggerHandler("web_share_browse"),window.locals.get("owner_vip_type","owner_vip_level",function(n,i){if(2===n&&i){var s="vipicon-"+n+"-"+i;0===i&&(s+=" cover"),s+=" vipicon",o(".share-person-data .sicon").addClass(s)}2===n&&e("disk-share:widget/system/util/makeup.js")("sharelist",t)})},setCertIcon:function(){var e=this;i("sharelist",function(o){o.isCertUser&&o.useCertTheme?(e.sendReportLoggerHandler("web_enterprise_owner_share_browse"),o.isOwner||t.log.send({name:"understand_cert_share-person_display_count",value:"企业用户分享-外链-头像下-了解企业账号"}),e.setBannerHide()):e.setVipIcon()},function(){e.setVipIcon()})},sendReportLoggerHandler:function(e){1===+window.locals.get("loginstate")&&this.reportLogger(e)},setEnterpriseInfo:function(){var e=this;s("sharelist",function(o){o.isEnterpriseLink?(e.sendReportLoggerHandler("web_enterprise_share_browse"),t.log.send({type:"web_share_list_page_enterprise_display",value:"web-企业空间-文件列表页-展示"}),e.setBannerHide()):e.setCertIcon()},function(){e.setCertIcon()})},setBannerHide:function(){o("#web-right-view").hide(),o("#web-single-bottom").hide(),o("#web-multi-bottom").hide()},init:function(){this.getIntro(),this._bindEvent(),this.setEnterpriseInfo(),window.currentSekey=a("BDCLND")}};t.message.listen("share-person-info",function(e){"show-intro"===e&&g.getShareUserIntro()}),g.init()});
;define("disk-share:widget/pageModule/share-header/share-header.js",function(e){function t(){if("1"===l.getItem("transferFiles")){if(!window.locals.get("self")){try{storageFiles=l.getItem("transferFilesContent"),storageFiles=JSON.parse(storageFiles)}catch(e){console.log(e)}r.message.callPlugin("保存到网盘@com.baidu.pan.share",{filesList:storageFiles})}l.removeItem("transferFiles"),l.removeItem("transferFilesContent")}}function a(){"1"===l.getItem("shareAutoDownload")&&(r.message.callPlugin("网盘下载@com.baidu.pan"),l.removeItem("shareAutoDownload"))}var s=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/tools/tools.js"),l=e("base:widget/storage/storage.js"),r=e("system-core:context/context.js").instanceForSystem,o=e("disk-share:widget/system/util/util.js");e("disk-share:widget/pageModule/share-header/btns.js");var n=e("disk-share:widget/pageModule/share-header/subscribe-outside-link.js");n.init("old");var d=location.pathname.indexOf("/link/")>-1||/(\?|&)linksource=/.test(location.search),g=window.locals.get("file_list")||[],c=g[0]||{},m=i.toEntity(c.server_filename),h="",u=s(".module-share-header .file-name"),f=o.getSearch("pwd")||"",p=1===+c.wpfile;switch(p&&(m=m.replace(/\.(\w*?)$/,""),s("title").text(m+"_免费高速下载|百度网盘-分享无限制")),window.SHAREPAGETYPE){case"single_file_page":h=m.substring(m.lastIndexOf(".")+1).toLowerCase();break;case"multi_file":1===g.length&&c.isdir?h="dir":(h="multi",m+="等")}window.locals.get("cfrom_id","owner_vip_type","sharetype","title_img",function(e,t,a,i){if(r.log.send({name:"web_third_link_page_show",value:{value:"外链页展示",from:Number(e),from0:t,refer:document.referrer}}),r.log.send(f?{type:"web_auto_extract_shareLink_display",value:"自动填充提取码-外链页展示"}:{type:"web_need_extract_shareLink_display",value:"非自动填充提取码-外链页展示"}),"4"===String(a)&&s(".verify-user-protect-share-list").show(),1===g.length&&i&&!d){var l=i?'<img style="vertical-align: top;" src=data:image/png;base64,'+i[0]+">":'<img alt="'+m+'" >';u.attr("title","").html('<em class="global-icon-16 global-icon-16-'+h+'"></em> '+l)}else u.attr("title",m).html('<em class="global-icon-16 global-icon-16-'+h+'"></em> '+m)}),setTimeout(function(){var e=[".panHelperBtn","[data-key=downloadhelper]","[node-type=btn-helper]"],t=s(e.join(","));if(t.length)try{r.log.send({name:"sharePage_plugin_downloadhelper"}),s.each(t,function(e,t){t.remove()})}catch(a){}},1e3),t(),a()});
;define("disk-share:widget/system/util/lazyLoadImage.js",function(o,t,i){function a(){function o(){a.isReady=!0,r.isFunction(a.callback)&&a.callback()}o()}function n(o){if(o&&"2"===String(h.HTTPVersion))return"thumbnail10.baidupcs";var t=o?_:g;return h[t][f++%10]}function s(o){if(!o)return!1;if(o.src)return!1;var t=o.getAttribute("_src"),i=t.indexOf(u)>-1,a=t.indexOf(defaultThumbDomain)>-1;if(!i&&!a)return!1;var s=i?u:defaultThumbDomain,e=u;i&&m&&(e=n()),a&&(e=n(!0)),s!==e&&(t=t.replace(s,e)),o._src=t}function e(){l.call(this),this.images=[]}var r=o("base:widget/libs/underscore.js"),l=o("base:widget/tools/service/tools.event.js").EventEmitter,c=o("base:widget/tools/service/tools.util.js"),m="http:"===document.location.protocol,d=window.host&&window.host.HOST_D_PCS||"d.pcs.baidu.com",u=d,h={HTTPVersion:"1.1",normalDomains:[],thumbsDomains:[]},f=0,g="normalDomains",_="thumbsDomains",w=window.host&&window.host.SOURCE_VALUE,p=Number(w);isNaN(p)&&(window.host&&(window.host.HOST_BAIDU_PCS="baidupcs.com"),p=10);for(var b=0;p>b;b++){var I=".";window.host&&window.host.HOST_BAIDU_PCS&&2===p&&(I="-"),h.thumbsDomains.push("thumbnail"+b+I+(window.host&&window.host.HOST_BAIDU_PCS||"baidupcs.com"))}a.isReady=!1,a(),c.inherits(e,l),e.prototype.changeImages=function(o){if([].push.apply(this.images,o||[]),a.isReady)this._loadImage();else{var t=this;a.callback=function(){t._loadImage()}}},e.prototype._loadImage=function(){if(0!==this.images.length){var o=this.images.shift(),t=s(o);t!==!1&&(this._installImage(o),this._loadImage())}},e.prototype._installImage=function(o){var t=r.now(),i=this;o.hasError||(o.src=o._src),o.complete?i._loadImageSucc(o):(o.onload=function(){i._loadImageSucc(this,r.now()-t)},o.onerror=function(){o.hasError=!0,i._loadImageFail(this)})},e.prototype._loadImageSucc=function(o){this.emit("done",o),this._commonLoadImageCall(o)},e.prototype._loadImageFail=function(o){this.emit("fail",o),this._commonLoadImageCall(o)},e.prototype._commonLoadImageCall=function(o){o.onload=o.onerror=null,this._loadImage()},i.exports=e});
;define("disk-share:widget/pageModule/list/list-view-empty/list-view-empty.js",function(e,o,t){var i=e("base:widget/libs/jquerypacket.js"),d=e("base:widget/hash/hash.js"),n={dom:{module:".KPDwCE",searchEmptyModule:".empty-search-container",viewEmptyModule:".module-list-view-empty",noResultTcode:'a[node-type~="jmdowPMr"]',noResultTcodePic:'div[node-type~="cpkfgMXv"]',noResultTcodeClose:'a[node-type~="adzNQK7"]',newDirBox:'input[node-type~="xlwEQV"]',newDir:'div[node-type~="ol4Ypy"]'},bindEvent:function(){var e=!1,o=i(n.dom.module);o.delegate(n.dom.noResultTcode,"mouseover",function(){i(n.dom.noResultTcodePic).show()}),o.delegate(n.dom.noResultTcodePic,"mouseover",function(){e=!0}),o.delegate(n.dom.noResultTcodePic,"mouseleave",function(){i(n.dom.noResultTcodePic).hide()}),o.delegate(n.dom.noResultTcode,"mouseout",function(){setTimeout(function(){e||(i(n.dom.noResultTcodePic).hide(),e=!1)},200)}),o.delegate(n.dom.noResultTcodeClose,"click",function(){i(n.dom.noResultTcodePic).hide()})},tmpl:{emptyViewContainer:'<div class="clearfix module-list-view-empty" style="" node-type="ecuNBxK"><div class="list-view-empty-header"><div class="bar global-clearfix"><span class="chk"></span></div></div><div class="no-data"><div class="img"></div><p>没有数据...</p></div></div>',emptySearchContainer:'<div class="empty-search-container"><div class="search-empty-box"></div></div>'},util:{render:function(){i(n.tmpl.emptyViewContainer).appendTo(n.dom.module),i(n.tmpl.emptySearchContainer).appendTo(n.dom.module)}},init:function(){n.bindEvent()}};i(document).ready(function(){n.init()});var s={emptyView:function(){var e=d.get("search/key");return e?n.tmpl.emptySearchContainer:n.tmpl.emptyViewContainer}};t.exports=s});
;define("disk-share:widget/pageModule/list/grid-view/grid-view-builder.js",function(e,t,i){function a(e){C.gridViewContainer||(C.gridViewContainer=e.$gridViewContainer.find(".BNfIyPb")),C.itemHeight||(C.itemHeight=e.getCurrentView().itemHeight);var t=0;if(C.itemHeight>0){var i=C.gridViewContainer.scrollTop();t=Math.max(parseInt(i/C.itemHeight,10)-2,0)}C.load(t)}var s=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/libs/underscore.js"),r=e("base:widget/historyManager/historyManager.js"),l=e("disk-share:widget/system/util/util.js"),o=e("system-core:context/context.js").instanceForSystem,c=e("disk-share:widget/system/fileOperate/fileOperate.js"),d=e("disk-share:widget/system/util/lazyLoadImage.js"),m=o.message,h={LIST:"list",CATEGORY:"category",SEARCHPATH:"searchPath",SEARCHGLOBAL:"searchGlobal",SEARCH:"search"},u=function(){var e=document.createElement("dd");e.className="g-clearfix";var t=[];t.push('<div class="cEefyz">'),t.push('<span node-type="EOGexf" class="EOGexf"></span>'),t.push('<div class="JS-fileicon" title="">'),t.push('<img class="thumb"/>'),t.push('<span class="playIcon"></span>'),t.push("</div>"),t.push('<div class="file-name">'),t.push('<a node-type="wjNlqe" class="filename" href="javascript:void(0);" title=""></a>'),t.push("</div>"),t.push("</div>");for(var i=[],a=C.columnsCount=this.getColumnsCount(),s=0;a>s;s++)i.push(t.join(""));return e.innerHTML=i.join(""),e},g=null,p=null,v=function(){g=null,p=null},f=function(e,t,i){var a,n,d=t;null==d&&(d=this.buildView(e,t,i));for(var u,v=this.getGroupElementsData(),f=v[i],w=s(d),b=this,y=this.getColumnsCount(),k=w.find(".cEefyz"),I=0;I<f.length;I++){if(u=f[I],a=k[I],n=s(a),a.style.display="block",a.setAttribute("_position",i),this.isAllItemChecked()||this.isItemChecked(i*y+I)?n.addClass("JS-item-active"):n.removeClass("JS-item-active hover-item"),!a.getAttribute("_installed")){var S,L;n.mouseover(function(){if(S=(new Date).getTime(),b.parent.isLocked())return!1;var e=s(this);return e.addClass("hover-item"),!1}).mouseout(function(){if(b.parent.isLocked())return!1;var e=s(this);return e.removeClass("hover-item"),L=(new Date).getTime(),o.log.send({name:"gridListHover",value:L-S}),!1}),n.bind("click dblclick",function(e){var t=(new Date).getTime();if(b.parent.isLocked())return!1;var i,a=s(this),n=parseInt(a.attr("_position"),10),c=a.index(),d=n*y+c,u=b.getElementsData()[d],v=b.isItemChecked(d),f=!1;if(e.shiftKey){var C=b.getCheckedIndexs(),w=C[0];0===w||w||(w=d),b.setItemsChecked(!1);var k=w,I=d;if(I>k)for(;I>=k;)b.setItemChecked(k,!0),k++;else if(k>I)for(k=C[C.length-1];k>=I;)b.setItemChecked(k,!0),k--;else b.setItemChecked(k,!0);b.requestLayout()}else{if(!e.ctrlKey){if(1!==window.locals.get("loginstate")&&2===u.category&&u.size<52428800)return l.makePreviewMusicLogin(),!1;if(u.isdir)return b.setItemsChecked(!1),filename=u.server_filename,"string"==typeof u.path&&0===u.path.indexOf("/")&&(u.path=u.path.substr(1,u.path.length)),b.parent.cache.cacheName===h.SEARCH||b.parent.cache.cacheName===h.SEARCHGLOBAL||b.parent.cache.cacheName===h.SEARCHPATH?r.assignUrlHash("list/path="+encodeURIComponent(u.path)+"&vmode="+r.getCurrentParams().vmode):u.parent_path?b.parent.addHistory(u.path,u.server_filename,decodeURIComponent(u.parent_path)):b.parent.addHistory(u.server_filename,u.server_filename),!1;var S=a.data("plugin");if(S&&S.length)return m.trigger("plugin:"+S,{filesList:[u]}),!1;i=b.getCheckedIndexs(),i.length>0&&(v===!1||v&&i.length>1)&&(b.setItemsChecked(!1),f=!0),v&&i.length>1&&(v=!1)}g=d,p=null,b.setItemChecked(d,!v),f?b.requestLayout():v?a.removeClass("JS-item-active"):a.addClass("JS-item-active")}var L=(new Date).getTime();return o.log.send({name:"gridListSingleSel",value:L-t}),!1}).delegate(".EOGexf","click",function(e){var t=(new Date).getTime();if(b.parent.isLocked())return!1;e.stopPropagation();var i=s(this).closest(".cEefyz"),a=parseInt(i.attr("_position"),10),n=i.index(),r=a*y+n,l=b.isItemChecked(r);b.setItemChecked(r,!l),l?i.removeClass("JS-item-active"):i.addClass("JS-item-active");var c=(new Date).getTime();o.log.send({name:"gridListMultiSel",value:c-t})}).delegate(".EOGexf","dblclick",function(e){e.stopPropagation()}),a.setAttribute("_installed",1)}var A=c.getInfo(u.path,u.isdir,!1,!1,!1,u.wpfile);n.find(".playIcon").remove(),"fileicon-large-video"===A.largeIcon&&(n.find(".JS-fileicon").append('<span class="playIcon"></span>'),n.mouseenter(function(){s(this).find(".playIcon").show()}).mouseleave(function(){s(this).find(".playIcon").hide()})),n.find(".JS-fileicon").attr('class', 'JS-fileicon '+A.largeIcon),u.isdir||A.plugin?(n.addClass("open-enable"),n.data("plugin",A.plugin)):(n.removeClass("open-enable"),n.data("plugin",""));var _,H,J=n.find(".JS-fileicon img");J.removeAttr("src"),4!==u.category&&u.thumbs&&u.thumbs.url1?(H=u.thumbs.url1.replace("size=c140_u90","size=c180_u194"),(_=C.loadedImgMap[H])?(J.removeAttr("_src").attr("src",_.src).css({left:_.left,top:_.top,visibility:"visible"}),J.parent().attr('class', 'JS-fileicon')):J.removeAttr("src").attr("_src",H).css("visibility","hidden")):J.removeAttr("_src").removeAttr("src").css("visibility","hidden"),1===+u.wpfile&&(A.name=A.name.replace(/\.(\w*?)$/i,"")),n.find(".filename").html(A.name).attr("title",A.fileName).data("filename",u.server_name)}if(f.length!=y)for(var T=f.length;y>T;++T)k[T].style.display="none";return d},C={columnsCount:0,gridViewContainer:null,itemHeight:0,lazyLoadImagePlugin:new d,loadedImgMap:{},init:function(){this.lazyLoadImagePlugin.on("done",n.bind(this.imgLoadedSuccessFunc,this)),this.lazyLoadImagePlugin.on("fail",n.bind(this.imgLoadedFailFunc,this))},imgLoadedSuccessFunc:function(e,t){e=s(e);var i,a=0,n=0,r=e.width(),l=e.height();r>0&&l>0&&(a=(90-r)/2,n=(92-l)/2),i={left:a,top:n,visibility:"visible"},e.css(i).removeAttr("_src");var c=e.attr("src");if(!c)return!1;var d=c.replace(/http:\/\/d[0-9]\./,"http://d.");i.src=c,this.loadedImgMap[d]=i,e.parent().attr('class', 'JS-fileicon'),o.log.send({name:"s_imgLoad",value:t})},imgLoadedFailFunc:function(e){e=s(e),e.removeAttr("src"),e.removeAttr("_src")},checkCanLoad:function(e){for(var t=0,i=C.gridViewContainer,a=i.scrollTop(),s=i.height();e&&-1===e.className.indexOf("cEefyz");)e=e.parentNode,t+=e.offsetTop;return a-100>t?-1:t>a+s?0:1},load:function(e){for(var t=C.gridViewContainer,i=e?t.find("dd:gt("+e+")").find(".thumb[_src]"):t.find(".thumb[_src]"),a=[],s=0,n=i.length;n>s;s++){var r=i[s];if(!r)break;var l=this.checkCanLoad(r);if(0===l)break;-1!==l?1===l&&([].push.apply(a,[].slice.call(i,s,s+this.columnsCount)),s=s+this.columnsCount-1):s=s+this.columnsCount-1}this.lazyLoadImagePlugin.changeImages(a)}};C.init();var w=-1,b=0,y=1e3,k=/vmode=grid/.test(location.hash);i.exports={getView:f,buildView:u,onScroll:n.debounce(function(){if(k)return void(k=!1);var e=this.parent,t=n.now(),i=b;clearTimeout(w),b=t,t-i>y?a(e):w=setTimeout(a,y,e)},350),clear:v}});
;define("disk-share:widget/pageModule/list/list-view/list-view-builder.js",function(e,t,i){function a(){return d.Broker.getButtonBroker("shareList")}var s=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/historyManager/historyManager.js"),r=e("base:widget/tools/tools.js"),l=e("base:widget/tools/service/tools.date.js"),o=e("base:widget/tools/service/tools.format.js"),c=e("base:widget/tools/service/tools.path.js"),h=e("disk-share:widget/system/util/util.js"),d=e("system-core:context/context.js").instanceForSystem,g=e("disk-share:widget/system/fileOperate/fileOperate.js"),m=e("disk-share:widget/system/util/elinkThemeRender.js"),p=d.message;d.Broker.initButtonBroker({name:"shareList",config:{limit:3,container:s("<div>")}});var f={LIST:"list",CATEGORY:"category",SEARCHPATH:"searchPath",SEARCHGLOBAL:"searchGlobal",SEARCH:"search"},v=function(){var e=this.parent.listHeader.config.columns||[{width:60},{width:16},{width:23}],t=document.createElement("dd");return t.className="g-clearfix AuPKyz",t.innerHTML='<span node-type="EOGexf" class="EOGexf"></span><div class="JS-fileicon"></div><div class="file-name" style="width:'+e[0].width+'%"><div class="text"><a href="javascript:void(0);" class="filename"></a></div><div class="sybxeNb"></div></div><div class="file-size" style="width:'+e[1].width+'%">-</div>'+(e[2]?'<div class="ctime" style="width:'+e[2].width+'%"></div>':"")+'<div class="path-info" style="width:'+(e[3]?e[3].width-1:0)+'%"><span class="search-feild" node-type="aaxgDvz"></span></div>',t},u=null,w=null,b=function(){u=null,w=null},C=function(e,t){if(e&&0!==e.length)for(var i=0;i<e.length;i++){var a=s(e[i]),n=a.data("excludedir");if(n){var r=t.path.substring(1);-1!==n.indexOf(r)?a.addClass("g-disabled"):a.removeClass("g-disabled")}var l=a.data("includetype");if(l){var o=c.getFileCategory(t.path);-1===l.indexOf(o)?a.hide():a.show()}}},k=function(e){var t=/^[.,?\]})'";:`~!%&*|>，﹐。？、】）·！……’”；：]*/;if(e.highlighting&&e.highlighting.abstract){e.highlighting.abstractFixed=e.highlighting.abstract,e.highlighting.abstract=e.highlighting.abstract.replace(/\n+\s*\n/g,"\n"),e.highlighting.abstract=e.highlighting.abstract.replace(t,"");var i=e.highlighting.abstract;if(pos=i.search(/<em>/),pos>36){var a=pos-12;i=i.slice(a,i.length),e.highlighting.abstractFixed=i}e.highlighting.abstractFixed=e.highlighting.abstractFixed.replace(t,"")}return e},_=function(e,t){var i=t.length;if(!i)return!0;for(var a=e.filesType,s=a.split(","),n="",l=0,o=i;o>l;l++){var c=t[l];if(n=r.getFileCategory(c.server_filename||c.file_name),!n)return!1;if(~s.indexOf(n,s))return!0}return!1},y=function(e,t,i){var r=t;null==r&&(r=this.buildView(e,t,i));var c=this.getElementDataByPosition(i),v=s(r),b=this.parent.cache.cacheName===f.SEARCHGLOBAL,y=this;if(b&&(v.addClass("list-view-vip-search"),c=k(c)),r.setAttribute("_position",i),r.setAttribute("_cmd_installed",1),this.isAllItemChecked()||this.isItemChecked(i)?v.addClass("JS-item-active"):v.removeClass("JS-item-active hover-item"),!r.getAttribute("_installed")){var S,x;v.mouseenter(function(){if(S=(new Date).getTime(),y.parent.isLocked())return!1;var e=s(this),t=e.find(".sybxeNb");m.getTransferAndDownloadStatus(function(t){t.cantTransfer||t.cantDownload||e.addClass("hover-item")}),""===t.html()&&(t.html(a().getContent()),d.addIconFont&&d.message.trigger("addIcon",t[0]));var i=s(".tools-share-unzip");return _({filesType:"rar,zip",filesTypeStrongMatch:!0},[c])?i.css("display","inline-block"):i.css("display","none"),!1}).mouseleave(function(){if(y.parent.isLocked())return!1;var e=s(this);return e.removeClass("hover-item"),e.find(".g-dropdown-button").removeClass("button-open"),x=(new Date).getTime(),d.log.send({name:"listListHover",value:x-S}),!1}),v.click(function(e){var t=(new Date).getTime();if(y.parent.isLocked())return!1;var i=parseInt(this.getAttribute("_position"),10),a=y.isItemChecked(i),n=y.getCheckedIndexs(),r=e.ctrlKey,l=s(this);if(e.shiftKey){var o=Math.min(i,u),c=Math.max(i,u),h=l,g=!1;if("number"==typeof w){var m=Math.min(i,w),p=Math.max(i,w);for(g=m===i;p>=m;)y.setItemChecked(m,!1),h.length>0&&h.removeClass("JS-item-active"),h=g?h.next(".AuPKyz"):h.prev(".AuPKyz"),m++}for(h=l,g=o===i;c>=o;)y.setItemChecked(o,!0),h.length>0&&h.addClass("JS-item-active"),h=g?h.next(".AuPKyz"):h.prev(".AuPKyz"),o++;w=i}else u=i,w=null,r||(n.length>0&&(a===!1||a&&n.length>1)&&(y.setItemsChecked(!1),l.siblings(".AuPKyz").removeClass("JS-item-active")),a&&n.length>1&&(a=!1)),y.setItemChecked(i,!a),a?l.removeClass("JS-item-active"):l.addClass("JS-item-active");var f=(new Date).getTime();d.log.send({name:"listListSingleSel",value:f-t})}),v.delegate(".filename","click",function(){if(y.parent.isLocked())return!1;var e=parseInt(s(this).closest(".AuPKyz")[0].getAttribute("_position"),10),t=y.getElementDataByPosition(e);if(t.isdir)d.log.send({name:"web_share_click_list_dir",value:"外链列表页点击文件夹"}),"string"==typeof t.path&&0===t.path.indexOf("/")&&(t.path=t.path.substr(1,t.path.length)),y.parent.cache.cacheName===f.SEARCH||y.parent.cache.cacheName===f.SEARCHGLOBAL||y.parent.cache.cacheName===f.SEARCHPATH?n.assignUrlHash("list/path="+encodeURIComponent(t.path)+"&vmode="+n.getCurrentParams().vmode):t.parent_path?y.parent.addHistory(t.path,t.server_filename,decodeURIComponent(t.parent_path)):y.parent.addHistory(t.server_filename,t.server_filename);else{d.log.send({name:"web_share_click_list_file",value:{value:"外链列表页点击文件",category:t.category}});var i=t.path?t.path.match(/\.[a-zA-Z0-9]+$/):["unkown"],a=i?i[0]:"unkown";if(d.log.send({name:"web_share_list_preview_content",value:{value:"外链列表预览内容",from:a,path:t.path,fs_id:t.fs_id,md5:t.md5,from_uk:window.locals.get("share_uk")}}),window.locals.get("sharetype",function(e){"4"===String(e)&&d.log.send({type:"web_list_click_limitShare",value:"密享外链列表页预览内容总数"})}),1!==window.locals.get("loginstate")&&2===t.category&&t.size<52428800)return h.makePreviewMusicLogin(),!1;var r=v.data("plugin");if(!r||!r.length)return!0;p.trigger("plugin:"+r,{filesList:[t]})}return!1}).delegate(".g-button","click",function(){if(y.parent.isLocked())return!1;var e=parseInt(s(this).closest(".AuPKyz")[0].getAttribute("_position"),10),t=y.getElementDataByPosition(e),i=s(this).next(".menu");if(i.length){var n=i.find(".g-button-menu");return C(n,t),s(this).closest(".g-dropdown-button").toggleClass("button-open"),void(i.offset().top>s(window).height()-i.outerHeight()?i.addClass("more-list-up"):i.removeClass("more-list-up"))}var r=s(this).index()-1;a().triggerClick(r,{filesList:[t],position:[e]})}).delegate(".g-button-menu","click",function(){if(y.parent.isLocked())return!1;var e=parseInt(s(this).closest(".AuPKyz")[0].getAttribute("_position"),10),t=y.getElementDataByPosition(e),i=s(this).index();a().triggerClick(i,{filesList:[t],position:[e]}),s(this).closest(".g-dropdown-button").removeClass("button-open")}).delegate(".sybxeNb","click",function(e){return y.parent.isLocked()?!1:void e.stopPropagation()}).delegate(".EOGexf","click",function(e){var t=(new Date).getTime();if(y.parent.isLocked())return!1;d.log.send({name:"web_share_click_list_select",value:"外链列表页点击选择"}),e.stopPropagation();var i=s(this).closest(".AuPKyz"),a=parseInt(i.attr("_position"),10),n=y.isItemChecked(a);y.setItemChecked(a,!n),n?i.removeClass("JS-item-active"):i.addClass("JS-item-active");var r=(new Date).getTime();d.log.send({name:"listListMultiSel",value:r-t})}).delegate(".EOGexf","dblclick",function(e){e.stopPropagation()}).delegate(".search-feild","click",function(e){e.stopPropagation(),n.assignUrlHash("list/path="+encodeURIComponent(s(e.target).data("path"))+"&vmode="+n.getCurrentParams().vmode)}),v.bind("dblclick",function(){if(y.parent.isLocked())return!1;var e=parseInt(s(this)[0].getAttribute("_position"),10),t=y.getElementDataByPosition(e);if(t.isdir)"string"==typeof t.path&&0===t.path.indexOf("/")&&(t.path=t.path.substr(1,t.path.length)),y.parent.cache.cacheName===f.SEARCH||y.parent.cache.cacheName===f.SEARCHGLOBAL||y.parent.cache.cacheName===f.SEARCHPATH?n.assignUrlHash("list/path="+encodeURIComponent(t.path)+"&vmode="+n.getCurrentParams().vmode):t.parent_path?y.parent.addHistory(t.path,t.server_filename,decodeURIComponent(t.parent_path)):y.parent.addHistory(t.server_filename,t.server_filename);else{var i=v.data("plugin");if(!i||!i.length)return!0;p.trigger("plugin:"+i,{filesList:[t]})}return!1}),r.setAttribute("_installed",1)}var A=g.getInfo(c.path,c.isdir,!0,!1,!1,c.wpfile);if(b){if(1==c.category||3==c.category){var L=c.thumbs.url1.replace(/size=.*&/,"size=c50_u50&").replace(/&quality=100/,"&quality=80");v.find(".JS-fileicon").css("background","url("+L+") 50% 50% no-repeat")}else v.find(".JS-fileicon").removeAttr("style");v.find(".JS-fileicon").attr('class', 'JS-fileicon '+A.middleIcon)}else v.find(".JS-fileicon").attr('class', 'JS-fileicon '+A.smallIcon);if(c.isdir||A.plugin?(v.addClass("open-enable"),v.data("plugin",A.plugin)):(v.removeClass("open-enable"),v.data("plugin","")),b&&c.highlighting.filename?(1===+c.wpfile&&(c.highlighting.name=c.highlighting.replace(/\.(\w*?)$/i,"")),v.find(".filename").html(c.highlighting.filename).attr("title",A.fileName).data("filename",c.server_filename)):(1===+c.wpfile&&(A.name=A.name.replace(/\.(\w*?)$/i,"")),v.find(".filename").html(A.name).attr("title",A.fileName).data("filename",c.server_filename)),b){var H="";H+=c.highlighting&&c.highlighting.abstract?'<div node-type="shsNxyo" class="name name-desc" title=" '+c.highlighting.abstract.replace(/\<em\>/g,"").replace(/\<\/em\>/g,"")+'">':'<div node-type="shsNxyo" class="name name-desc" title="">',H+='<span class="name-text-wrapper">',H+=c.highlighting.abstractFixed?'<span node-type="yzOBbsb" class="yzOBbsb">'+c.highlighting.abstractFixed+"</span>":'<span node-type="yzOBbsb" class="yzOBbsb">'+(c.highlighting.abstract||"")+"</span>",H+="</span></div>",0===v.find(".name-desc").length?v.find(".file-name").append(H):v.find(".name-desc").html(H)}if(v.find(".file-size").text(c.isdir?"-":1===+c.wpfile?"-":o.toFriendlyFileSize(c.size)),c.server_mtime||(c.server_mtime="-"),v.find(".ctime").text("-"===c.server_mtime?c.server_mtime:l.parseDate(c.server_mtime)),this.parent.cache.cacheName===f.SEARCH||this.parent.cache.cacheName===f.SEARCHGLOBAL||this.parent.cache.cacheName===f.SEARCHPATH){var I=c.path.split("/"),J="",E="";2===I.length?(J="/",E="全部文件"):(J=I.slice(0,I.length-1).join("/"),E=I[I.length-2]),v.find(".search-feild").data("path",J).attr("title",E).text(E)}return r};i.exports={getView:y,buildView:v,clear:b}});
;define("disk-share:widget/pageModule/list/share-multi.js",function(e){var s=e("system-core:context/context.js").instanceForSystem;s.message.trigger("share-person-info","show-intro"),e("disk-share:widget/system/util/adPlatform/adPlatform.js").getAdResoucre({list:[{id:"web-sharelinkpic",w:200,h:200},{id:"web-sharemultibanner",w:960,h:60},{id:"web-sharelinkrepeat",w:1,h:1}]})});
;define("disk-share:widget/pageModule/toolbar/toolbar.js",function(i){var e=i("base:widget/libs/jquerypacket.js"),t=i("system-core:context/context.js").instanceForSystem,o=t.message,d=e(".module-toolbar"),s={listGridSwitch:".list-grid-switch",listSwitch:".list-switch",gridSwitch:".grid-switch",prevDom:"div.prev-dom",afterDom:"div.after-dom",defaultDom:"div.default-dom",userDom:"div.user-dom",timeLineDom:"div.yun-pic-bar"};t.Broker.initButtonBroker({name:"shareTools",config:{container:d.find(".bar"),limit:4}});var n=function(i){null!==localStorage&&localStorage.setItem("chooseviewtype",i)};d.on("click",s.listSwitch,function(){if(!e(this).parent().hasClass("list-switched-on")){var i={type:"list"};n("list"),o.trigger("system-show-view-mode",i)}}),d.on("click",s.gridSwitch,function(){if(!e(this).parent().hasClass("grid-switched-on")){var i={type:"grid"};n("grid"),o.trigger("system-show-view-mode",i)}}),o.listen("system-update-view-mode",function(i){var e=d.find(s.listGridSwitch);"list"===i.type?(e.addClass("list-switched-on").removeClass("grid-switched-on"),e.find("a[node-type=uxmvNzbL]").hide(),e.find("a[node-type=vt43Oy]").show()):(e.removeClass("list-switched-on").addClass("grid-switched-on"),e.find("a[node-type=uxmvNzbL]").show(),e.find("a[node-type=vt43Oy]").hide())});var r=!1,a=!1;t.extend({toolbar:{afterDom:function(i,t){if(i){if(a)return;t===!0&&(a=!0),d.find(s.afterDom).html("").append(i).show()}else i===!1?(d.find(s.afterDom).html(""),a=!1):d.find(s.afterDom).hide();e(window).trigger("resize")},prevDom:function(i,t){if(i){if(r)return;t===!0&&(r=!0),d.find(s.prevDom).html("").append(i).show()}else i===!1?(d.find(s.prevDom).html(""),r=!1):d.find(s.prevDom).hide();e(window).trigger("resize")},showDefault:function(){d.find(s.userDom).hide(),d.find(s.defaultDom).show(),d.find(s.prevDom).children().length&&d.find(s.prevDom).show(),d.find(s.afterDom).children().length&&d.find(s.afterDom).show(),d.find(s.timeLineDom).hide(),d.removeClass("module-toolbar-hackbg")},setDom:function(i){d.find(s.defaultDom).hide(),d.find(s.prevDom).hide(),d.find(s.afterDom).hide(),d.find(s.timeLineDom).hide(),d.find(s.userDom).html("").append(i).show(),d.removeClass("module-toolbar-hackbg"),e(window).trigger("resize")},showTimelineDom:function(){d.find(s.defaultDom).hide(),d.find(s.prevDom).hide(),d.find(s.afterDom).hide(),d.find(s.userDom).hide(),d.find(s.timeLineDom).show(),d.addClass("module-toolbar-hackbg"),e(window).trigger("resize")}}})});