define("disk-share:widget/pageModule/list/listInit-new.js",function(e,t,i){var r=e("base:widget/libs/underscore.js"),a=e("base:widget/historyManager/historyManager.js"),n=e("base:widget/tools/tools.js"),o=e("base:widget/libs/jquerypacket.js"),s=e("system-core:context/context.js"),l=e("disk-share:widget/pageModule/list/list-view/list-view-builder.js"),c=e("disk-share:widget/pageModule/list/grid-view/grid-view-builder.js"),d=e("disk-share:widget/pageModule/list/list-view-empty/list-view-empty.js"),h=e("disk-share:widget/system/util/getCookies.js"),u=e("disk-share:widget/system/util/util.js"),g=s.instanceForSystem,m=g.ui.cacheManage,f=g.message,v="list",y="dir",p="category",w=".KPDwCE",C="JS-module-list-multselected",k={listViewContainer:".vdAfKMb",gridViewContainer:".JKvHJMb",listViewItem:".AuPKyz",gridViewItem:".cEefyz"},S=o(w),b=Math.max(o(window).height(),600)-190-40-60;S.css({height:b+"px"});var P=function(){var e={defaultViewModle:v};e.historyConfig=L(),e.listConfig=_(),e.listViewBuilder=I(),e.gridConfig=j(),e.gridViewBuilder=H(),e.listToolsConfig=M();var t=g.ui.list(w,e);s.setList(t);var i=e.listToolsConfig;return i.config.container=t.listHeader.getOperateContainer(),g.Broker.initButtonBroker(i),t.setListTools(g.Broker.getButtonBroker(i.name)),window.currentSekey=h("BDCLND"),t},B={3:"全部图片",2:"全部音乐",4:"全部文档",1:"全部视频",7:"全部种子",6:"其他文件"},L=function(){return{}},_=function(){var e={defaultScroll:!0,listItemClass:"AuPKyz",itemActiveClass:"JS-item-active"};return e},I=function(){return l},j=function(){return{defaultScroll:!0,columnWidth:124,gridItemClass:"cEefyz",itemActiveClass:"JS-item-active"}},H=function(){return c},M=function(){return{name:"shareListTools",config:{cachePaddingLeft:!1,limit:8,outSize:36,resize:!0}}},O=P();O.onListOrderChange=function(e,t){if(localStorage){var i="localshareorder_"+(window.locals.get("uk")||"");if(e)return void localStorage.setItem(i,e+"_"+t);var r=a.getCurrentParams();if(r&&"3"===r.type)return null;var n=localStorage.getItem(i)||"",o=n.split("_");return n&&2===o.length?{item:o[0],desc:parseInt(o[1],10)}:null}};var x=function(e){e&&-1===e.errno?g.ui.tip({msg:'由于您的帐号存在违规行为，帐号已被封禁。<a href="http://help.baidu.com/add?prod_id=48">申诉</a>',mode:"caution",autoClose:!1,hasClose:!0}):e&&e.errno&&g.ui.tip({msg:e.show_msg||g.errorMsg(e.errno)||"网络错误，请稍候重试",mode:"caution",autoClose:!1,hasClose:!0}),O.updateLoadingTips(2,0),O.listEmptyTip(O.$emptyTips)},V=function(){var e,t,i=O.onListOrderChange(),r="";r=decodeURIComponent(r?r:""),i&&(e=i.item,t="number"==typeof i.desc?i.desc:1);var a=window.location.pathname.split("/s/"),n="";return a.length>1&&(n=decodeURIComponent(localStorage.getItem(a[1]+"_bdclnd")||"")),{api:"/share/list",params:{is_from_web:!!n,sekey:n,uk:window.locals.get("share_uk"),shareid:window.locals.get("shareid"),order:e||"time",desc:void 0!==t?t:1,showempty:0,view_mode:1,web:1},limit:100,currentPage:0,listKey:"list",parentPath:r,getParamsBykey:function(e){return{dir:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.dir},failCallBack:function(e,t){x(e,t)}}},T=function(){var e,t,i=O.onListOrderChange();return i&&(e=i.item,t="number"==typeof i.desc?i.desc:1),{api:"/api/categorylist",params:{order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"info",getParamsBykey:function(e){return{category:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.category},failCallBack:function(e,t){x(e,t)}}},J=a.getDefault();O.onListOrderChange("other",1);var $=new m("list",V(),""),D=new m("category",T(),""),F=window.locals.get("file_list")||[];$.selfAddDataToCache("list","/",F,!1,0),window.locals.get("sharetype",function(e){F&&F.length>0&&"4"===String(e)&&g.log.send({type:"web_list_limitShare",value:"密享外链页面-有内容"})}),F&&F.length>0&&!window.locals.get("self")&&g.log.send({type:"web_shareRetailGuideShow",value:"转存按钮带红包展现"}),f.listen("system-show-view-mode",function(e){return O.isLocked()?void(e.returnValue=!1):(f.trigger("system-change-view-mode-loadingtip"),void et(e.type))}),O.onViewModuleChange=function(e){f.trigger("system-update-view-mode",{type:e}),O.listHeader.changeVmode({type:e})};var A=function(e){var t,i=e&&e.path;"undefined"!=typeof e&&e.all===!0?rt.removeCacheAll():e&&e.flagChangeSuffix||("undefined"!=typeof i&&(i=i||"/",rt.removeCache(i)),z===v?(t=a.getCurrentParams(),i=t.path||"/",i&&rt.removeCache(i)):z===p&&rt.removeCategoryCache()),O.refreshList()};f.listen("system-refresh",function(e){A(e)}),O.onCheckeChanged=function(e){e>1?S.addClass(C):S.removeClass(C),u.operateShareListButtonStyle(this)},O.onLockChanged=function(){},O.onLoadedCallBack=function(){f.trigger("after-list-loaded")},O.mapFirstFileByCategory=function(e,t){var i=null;if(e.length<=0)return i;i={};var r=O.getFirstPosition();if(0>r)return i;for(var a,s,l=O.getDomByPosition(r),c=null;null!==l&&e.length>0;){if(c=O.getElementDataByPosition(r),c&&!c.isdir&&c.server_filename&&(a=n.getFileCategory(c.server_filename))&&a&&(a="."+a,!i[a]&&(s=o.inArray(a,e))>=0&&(e.splice(s,1),t.call(null,a,o(l)))))return;l=O.getDomByPosition(++r)}},O.getIndexsByFiles=function(e){return O.cache.getIndexsByFiles(e)},O.remove=function(){},O.removeCacheByPath=function(e){rt.removeCache(e)};var K=function(){I().clear(),H().clear()},z=v,E=function(e,t){var i=a.buildHistory(e,t);J.addHistory(i)},N=function(e,t){var i=e.vmode;O.setViewModule("grid"===i?"grid":"list",t)},R=function(e,t){return f.trigger("system-change-toolbar",{module:O.cache.cacheName}),"category"===e&&3===t?void g.toolbar.showTimelineDom():void g.toolbar.showDefault()},U=function(){var e,t,i=O.onListOrderChange();i&&(e=i.item,t="number"==typeof i.desc?i.desc:1);var r=[{order:e||"server_filename",desc:void 0!==t?t:1,operateOrderKey:function(){},columns:[{name:"文件名",key:"server_filename",checkbox:!0,width:60},{name:"大小",key:"size",width:16},{name:"修改日期",key:"time",width:23}],module:["list","category"]}],a=location.pathname.indexOf("/link/")>-1;return a&&(r[0].columns=[{name:"文件名",key:"server_filename",checkbox:!0,width:75},{name:"大小",key:"size",width:16}]),r},W=function(e){for(var t=U(),i=O.cache&&O.cache.cacheName,r=e.cacheName,a=null,n=[],s=0;s<t.length;s++){if(a=t[s],n=a.module,-1!==o.inArray(i,n)&&-1!==o.inArray(r,n)&&"category"!==r)return;if(-1!=o.inArray(r,n))return O.changeHeaderConfig(a),e.config.params.order=a.order,void(e.config.params.desc=a.desc)}},q=function(e){I().clear();var t=e.path,i=e.parentPath;"undefined"==typeof t&&(t=""),N(e),O.$listHeader.show(),X(t,i),R("list",t),K()},G=function(e){E(v,e)},Q=function(e){var t=e.type,i=parseInt(t,10);N(e),Y(i),R("category",i),K()},X=function(e,t){z=v,W($),O.changeCache($),"/"===e&&(e=""),/\S\/+$/.test(e)&&(e=e.replace(/\/+$/,""));var i=e.split("/"),r=i.slice(),t=t||"";t||(t=a.getCurrentParams().parentPath||"");var n=t.split("/");n[0]="/",i[0]="/",r[0]="全部文件",O.changeHistory(i,r,n)},Y=function(e){z=p,W(D),O.changeCache(D);var t=B[e];if(t){var i=[e],r=[t];O.changeHistory(i,r)}else Z(["/"])};O.extend({getCheckMsg:function(e){return"已选中"+e+"个文件/文件夹"},resizeScrollBar:function(e){var t=this.$container;if("number"==typeof e||"string"==typeof e?t.height(e):e=t.height(),0===e)throw"[Error] list container's height is 0, need to set";t.height(e);var i=this.listHeader.hasInit===!1?0:55;"none"===t.find(".JDeHdxb").css("display")?(t.find(".NHcGw").height(e-i).find(".scrollbar-tracker").height(e-i-2-26),t.find(".BNfIyPb").height(e-i).find(".scrollbar-tracker").height(e-i-2-26)):(t.find(".NHcGw").height(e-75).find(".scrollbar-tracker").height(e-75-2),t.find(".BNfIyPb").height(e-75).find(".scrollbar-tracker").height(e-75-2))},checkLocalSort:function(){return!0},localSort:function(e,t,i){var r=e.key,a=e.getCache().list.data[r].list;"time"===t&&(t="server_mtime"),a.sort(function(e,i){return e[t]>i[t]?1:-1}),i&&a.reverse()}}),O.addHistory=function(e,t,i){var r=O.getHistoryIds();r=r?r.slice():[],r.push(e);var i=i||"";i||(i=a.getCurrentParams().parentPath||""),Z(r,i)},O.goHistory=function(e,t){var i=a.getCurrentParams(),r={};i.vmode&&(r.vmode=i.vmode),t?/\S\/+$/.test(t)&&(t=t.replace(/\/+$/,"")):t="/",r.path=t,E(e,r)};var Z=function(e,t){z=v,1!==e.length&&(e[0]="");var i=a.getCurrentParams(),r={};i.vmode&&(r.vmode=i.vmode);var n=e.join("/");/\S\/+$/.test(n)&&(n=n.replace(/\/+$/,"")),r.path=n,t&&(r.parentPath=t),E(z,r)},et=function(e){var t=a.getCurrentParams();t.vmode="grid"===e?"grid":"list",E(z,t)};O.getHistoryList().goToHistory=function(e,t){if(!(e>=this.historyList.length||0>e)){var i=this.historyList.slice(),r=this.historyListParents.join("/");r=r.replace(/\/\//,"/");var a=this.historyListParents.length-1;t&&e-1===a&&(e=1,a=0),(1===e||e===this.historyList.length-1)&&(a=0),i.splice(e+a,this.historyList.length),Z(i,r)}},J.listen(v,q),J.listen(y,G),J.listen(p,Q);var tt=function(){var e=a.getCurrentHash();return e&&e.length>1&&e[1]&&(e[0]===v&&e[1]&&e[1].path||e[0]===p&&e[1]&&e[1].type||e[0]===y&&e[1]&&e[1].path)?(z=e[0],!0):!1};tt()?a.interpretCurrentWindow():O.addHistory("/","全部文件");var it=r.throttle(function(){var e=Math.max(o(window).height(),600)-190-40;O.resize(e-60)},300);o(window).resize(it),O.listHeader.canTriggerOrder=function(){return!0},O.cancelEidtingDir=function(){},O.cancelFilesSelect=function(){S.find(".AuPKyz").removeClass("JS-item-active"),S.find(".cEefyz").removeClass("JS-item-active"),O.setItemsChecked(!1,!0)};var rt={getCache:function(){return m.getCache()},deleteCacheByMode:function(e,t,i){var r=t.getDataByKey();this.removeCacheAll();for(var a=r&&r.list,n=!1,o="",s="",l=a.length,c=l-1;c>=0;c--){for(var d=i.length,h=d-1;h>=0;h--)o=i[h],s=o.path||o,a[c].path==s&&(i.splice(h,1),n=!0);n&&(a.splice(c,1),n=!1)}return r.list=a,rt.getCache()[t.cacheName].data[t.getKey()]=r,r},removeCacheByPath:function(e){var t=this.getCache(),i={};t&&t.list&&t.list.data&&(i=t.list.data),i[e]&&delete i[e]},removeCacheAll:function(){var e=this.getCache();if("[object Object]"===Object.prototype.toString.call(e))for(var t in e)e.hasOwnProperty(t)&&e[t]&&e[t].data&&(e[t].data={})},removeCache:function(e,t,i){var r=this.getCache(),a={};r&&r.list&&r.list.data&&(a=r.list.data),this.removeSubFiles(a,e),"move"===t&&this.removeSubFiles(a,i),this.removeOtherListCache()},removeSubFiles:function(e,t){t="/"===t?t:t+"/";for(var i in e)e.hasOwnProperty(i)&&0===(i+"/").indexOf(t)&&delete e[i]},removeOtherListCache:function(){this.removeCategoryCache(),this.removeTreeCache()},removeCategoryCache:function(){this.removeCacheByKey("category")},removeTreeCache:function(){this.removeCacheByKey("tree")},removeCacheByKey:function(e){var t=this.getCache();t&&t[e]&&t[e].data&&(t[e].data={})}};e.async("disk-share:widget/pageModule/list/mouse-utils/mouse-select.js",function(e){new e({$dom:o(k.listViewContainer),item:k.listViewItem,viewMod:"list",selectClass:"JS-item-active",list:O,canSelect:function(){return O.isLocked()?!1:void 0}}),new e({$dom:o(k.gridViewContainer),item:k.gridViewItem,vieMod:"grid",selectClass:"JS-item-active",list:O,canSelect:function(){return O.isLocked()?!1:void 0}})}),O.listEmptyTip=function(e){O.$listHeader.hide(),e.html(d.emptyView).show()};var at=function(){var e=document.referrer,t="fm_self",i=/(http|https)\:\/\/(tieba|hao123)\.baidu\.com/gi,r=/(http|https)\:\/\/www\.hao123\.com/gi;return"string"==typeof e&&e.length>0&&(t=i.test(e)?"fm_"+RegExp.$2:r.test(e)?"fm_hao123":-1!==e.indexOf("http://www.baidu.com/s?wd=")?"fm_baidups":"fm_not_proved"),t};g.log.sendUserReport(at()),i.exports=O});
;define("disk-share:widget/pageModule/list/listMenu-new.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),t=e("system-core:context/context.js").instanceForSystem,s=e("disk-share:widget/pageModule/list/listInit-new.js"),n=void 0,r={listTarget:".zJMtAEb",gridTarget:".fyQgAEb"},o={top:[{title:"打开",action:function(){s.isGridMode()?i(this).closest(".cEefyz").find(".filename").trigger("click"):i(this).closest(".AuPKyz").find(".filename").trigger("click")},display:function(){if(s.getCheckedIndexs().length>1)return"disable";var e=i(this).closest(".AuPKyz");return s.isGridMode()&&(e=i(this).closest(".cEefyz")),e.length&&!e.hasClass("open-enable")?"disable":void 0},keyboard:"o"}],middle:[],bottom:[]};t.Broker.initMenuBroker({target:i(r.listTarget)[0],type:"share",config:o,events:{beforeMenu:function(){var e=i(this).closest(".AuPKyz")[0];if(!e)return!1;s.cancelEidtingDir();var t=parseInt(e.getAttribute("_position"));n=t,s.isItemChecked(t)||(s.setSingleItemChecked(t,!0),i(this).closest(".zJMtAEb").is(":visible")?i(this).closest(".NHcGw").find(".AuPKyz").removeClass("JS-item-active"):i(this).closest(".BNfIyPb").find(".cEefyz").removeClass("JS-item-active"),i(e).addClass("JS-item-active")),i(e).removeClass("hover-item")},afterMenu:function(){s.lock(!0)},menuHide:function(){s.lock(!1)}}}),t.Broker.initMenuBroker({target:i(r.gridTarget)[0],type:"share",config:o,events:{beforeMenu:function(){var e=i(this).closest(".cEefyz")[0];if(!e)return!1;s.cancelEidtingDir();var t=parseInt(e.getAttribute("_position")),r=i(e).index();n=s.getGridPostiion(t,r),s.isItemChecked(n)||(s.setSingleItemChecked(n,!0),i(this).closest(".BNfIyPb").find(".cEefyz").removeClass("JS-item-active"),i(e).addClass("JS-item-active")),i(e).removeClass("hover-item")},afterMenu:function(){s.lock(!0)},menuHide:function(){s.lock(!1)}}})});
;define("disk-share:widget/pageModule/start/multi-new.js",function(e){e("disk-share:widget/system/util/contextExtend.js"),e("disk-share:widget/pageModule/share-header/share-header-new.js"),e("disk-share:widget/pageModule/share-header/share-top-bar/share-top-bar.js"),e("disk-share:widget/pageModule/share-person-info/share-person-info-new.js"),e("disk-share:widget/pageModule/sidebar-business-ad/sidebar-business-ad.js"),e("disk-share:widget/pageModule/toolbar/toolbar.js"),e("disk-share:widget/pageModule/list/listInit-new.js"),e("disk-share:widget/pageModule/list/listMenu-new.js"),e("disk-share:widget/pageModule/list/share-multi.js"),e("disk-share:widget/pageModule/start/preFetchData.js");var s=e("system-core:context/context.js").instanceForSystem.spy;s.performance("multi_page","web-share"),s.getSpyInstance(function(){var e=window.locals.get("ufcTime");e&&s.sendTimePerf("shareList",e,{group:"share_perf",project:"web-share",pageName:"multi_page",clientType:"web"}).end({whiteScreen:Math.round(window.__perf_white_screen),firstScreen:Math.round(window.__perf_first_screen),completeScreen:Math.round(performance.now())})})});